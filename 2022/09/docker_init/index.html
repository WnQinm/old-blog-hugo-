<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>Docker - Qinm&#39;s blog</title><meta name="Description" content="Qinm&#39;s blog"><meta property="og:title" content="Docker" />
<meta property="og:description" content="docker基础知识学习笔记，来源于bilibili up主 &lsquo;遇见狂神说&rsquo;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://WnQinm.github.io/2022/09/docker_init/" />
<meta property="og:image" content="https://WnQinm.github.io/logo.png"/>
<meta property="article:published_time" content="2022-09-18T01:32:42+08:00" />
<meta property="article:modified_time" content="2022-10-12T18:12:52+08:00" /><meta property="og:site_name" content="blog" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://WnQinm.github.io/logo.png"/>

<meta name="twitter:title" content="Docker"/>
<meta name="twitter:description" content="docker基础知识学习笔记，来源于bilibili up主 &lsquo;遇见狂神说&rsquo;"/>
<meta name="application-name" content="Qinm&#39;s blog">
<meta name="apple-mobile-web-app-title" content="Qinm&#39;s blog"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://WnQinm.github.io/2022/09/docker_init/" /><link rel="prev" href="https://WnQinm.github.io/2022/09/clash_linux/" /><link rel="next" href="https://WnQinm.github.io/2022/09/html_init/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css"></noscript><link rel="preload" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Docker",
        "inLanguage": "zh-CN",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/WnQinm.github.io\/2022\/09\/docker_init\/"
        },"image": [{
                            "@type": "ImageObject",
                            "url": "https:\/\/WnQinm.github.io\/images\/Apple-Devices-Preview.png",
                            "width":  3200 ,
                            "height":  2048 
                        }],"genre": "posts","keywords": "net, docker","wordcount":  11990 ,
        "url": "https:\/\/WnQinm.github.io\/2022\/09\/docker_init\/","datePublished": "2022-09-18T01:32:42+08:00","dateModified": "2022-10-12T18:12:52+08:00","publisher": {
            "@type": "Organization",
            "name": "xxxx","logo": "https:\/\/WnQinm.github.io\/images\/avatar.png"},"author": {
                "@type": "Person",
                "name": "清梦"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Qinm&#39;s blog"><span class="header-title-pre"><i class='fa-solid fa-cloud' aria-hidden='true'></i></span>Qinm&#39;s Blog</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> 所有文章 </a><a class="menu-item" href="/tags/"> 标签 </a><a class="menu-item" href="/categories/"> 分类 </a><span class="menu-item delimiter"></span><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Qinm&#39;s blog"><span class="header-title-pre"><i class='fa-solid fa-cloud' aria-hidden='true'></i></span>Qinm&#39;s Blog</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a class="menu-item" href="/posts/" title="">所有文章</a><a class="menu-item" href="/tags/" title="">标签</a><a class="menu-item" href="/categories/" title="">分类</a><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><main class="main">
                <div class="container">
                    <div class="toc" id="toc-auto">
            <h2 class="toc-title">目录</h2>
            <div class="toc-content always-active" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Docker</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="/" title="Author" rel="author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>清梦</a></span>&nbsp;<span class="post-category">收录于 <a href="/categories/docker/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>Docker</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2022-09-18">2022-09-18</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;约 11990 字&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;预计阅读 24 分钟&nbsp;</div>
        </div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>目录</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ol>
    <li><a href="#intro">intro</a></li>
    <li><a href="#docker能做什么">Docker能做什么</a>
      <ol>
        <li><a href="#虚拟机技术">虚拟机技术</a></li>
        <li><a href="#容器化技术">容器化技术</a></li>
      </ol>
    </li>
    <li><a href="#docker基本组成">Docker基本组成</a></li>
    <li><a href="#install-docker">install Docker</a>
      <ol>
        <li><a href="#系统版本">系统版本</a></li>
        <li><a href="#帮助文档ubuntu">帮助文档（ubuntu）：</a></li>
        <li><a href="#install-using-the-repository">install using the repository</a></li>
        <li><a href="#设置阿里云镜像软件源">设置阿里云镜像软件源</a></li>
        <li><a href="#install-docker-engine">install Docker Engine</a></li>
        <li><a href="#启动docker">启动docker</a></li>
        <li><a href="#测试hello-world">测试hello-world</a></li>
        <li><a href="#查看已有镜像列表">查看已有镜像列表</a></li>
      </ol>
    </li>
    <li><a href="#卸载docker">卸载Docker</a></li>
    <li><a href="#docker的常用命令">Docker的常用命令</a>
      <ol>
        <li><a href="#帮助命令">帮助命令</a></li>
        <li><a href="#镜像命令">镜像命令</a></li>
        <li><a href="#容器命令">容器命令</a></li>
        <li><a href="#常用其他命令">常用其他命令</a></li>
        <li><a href="#小结">小结</a></li>
        <li><a href="#练习">练习</a>
          <ol>
            <li><a href="#nginx">nginx</a></li>
            <li><a href="#tomcat">tomcat</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#docker镜像讲解">Docker镜像讲解</a>
      <ol>
        <li><a href="#镜像是什么">镜像是什么</a></li>
        <li><a href="#docker镜像加载原理">Docker镜像加载原理</a></li>
        <li><a href="#commit镜像">commit镜像</a></li>
      </ol>
    </li>
    <li><a href="#容器数据卷">容器数据卷</a>
      <ol>
        <li><a href="#什么是容器数据卷">什么是容器数据卷</a></li>
        <li><a href="#使用数据卷">使用数据卷</a></li>
        <li><a href="#安装mysql">安装MySQL</a></li>
        <li><a href="#具名和匿名挂载">具名和匿名挂载</a></li>
        <li><a href="#dockerfile初识">Dockerfile初识</a></li>
        <li><a href="#数据卷容器">数据卷容器</a></li>
      </ol>
    </li>
    <li><a href="#dockerfile">Dockerfile</a>
      <ol>
        <li><a href="#dockerfile构建过程">DockerFile构建过程</a></li>
        <li><a href="#dockerfile指令">dockerfile指令</a></li>
        <li><a href="#实操">实操</a></li>
        <li><a href="#发布镜像到dockerhub">发布镜像到dockerhub</a></li>
      </ol>
    </li>
    <li><a href="#docker-网络">docker 网络</a>
      <ol>
        <li><a href="#自定义网络">自定义网络</a></li>
        <li><a href="#网络连通">网络连通</a></li>
      </ol>
    </li>
  </ol>
</nav></div>
            </div><div class="content" id="content"><p>docker基础知识学习笔记，来源于bilibili up主 &lsquo;遇见狂神说&rsquo;</p>
<h1 id="intro">intro</h1>
<p>Docker是基于Go语言开发的开源项目
官网：https://www.docker.com/
文档：https://docs.docker.com/ 超级详细
仓库：https://hub.docker.com/</p>
<h1 id="docker能做什么">Docker能做什么</h1>
<p>一般来说，电脑有内核（Kernel），库/环境（Lib），以及各种应用app</p>
<h2 id="虚拟机技术">虚拟机技术</h2>
<p>模拟了绝大部分组成，导致一些缺点：
1、资源占用多
2、冗余步骤多
3、启动慢
<img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tva4.sinaimg.cn/large/007Z9xVHgy1h68cf4f1x0j30x60p5mzw.jpg"
        data-srcset="https://tva4.sinaimg.cn/large/007Z9xVHgy1h68cf4f1x0j30x60p5mzw.jpg, https://tva4.sinaimg.cn/large/007Z9xVHgy1h68cf4f1x0j30x60p5mzw.jpg 1.5x, https://tva4.sinaimg.cn/large/007Z9xVHgy1h68cf4f1x0j30x60p5mzw.jpg 2x"
        data-sizes="auto"
        alt="https://tva4.sinaimg.cn/large/007Z9xVHgy1h68cf4f1x0j30x60p5mzw.jpg"
        title="virtual machine tech" /></p>
<h2 id="容器化技术">容器化技术</h2>
<p>没有模拟一个完整的操作系统，只打包了Lib和各种apps，这些docker共用一个内核，可以最大化压榨内核潜力，同时各个docker互不干扰，避免某个docker环境等配置失败导致机器不能正常使用</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tva2.sinaimg.cn/large/007Z9xVHgy1h68cic0sykj30xp0p8gos.jpg"
        data-srcset="https://tva2.sinaimg.cn/large/007Z9xVHgy1h68cic0sykj30xp0p8gos.jpg, https://tva2.sinaimg.cn/large/007Z9xVHgy1h68cic0sykj30xp0p8gos.jpg 1.5x, https://tva2.sinaimg.cn/large/007Z9xVHgy1h68cic0sykj30xp0p8gos.jpg 2x"
        data-sizes="auto"
        alt="https://tva2.sinaimg.cn/large/007Z9xVHgy1h68cic0sykj30xp0p8gos.jpg"
        title="docker tech" /></p>
<p>由于容器没有内核，也没有虚拟其他硬件，使得容器十分轻便，我们可以安装多个docker</p>
<p><strong>应用更快速的交付和部署</strong>
传统：一堆帮助文档，安装程序
Docker：打包镜像发布测试，一键运行</p>
<p><strong>更便捷的升级和扩缩容</strong>
可以类似搭积木来部署应用</p>
<p><strong>更简单的系统运维</strong>
容器化之后，我们的开发，测试环境都是高度一致的</p>
<p><strong>更高效的计算资源利用</strong>
Docker是内核级别的虚拟化，可以在一个物理机上运行很多的容器实例。服务器的性能可以被压榨到极致</p>
<h1 id="docker基本组成">Docker基本组成</h1>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="http://blog.kevinyang.net/2020/07/30/docker-101-note-1/screen-shot-2020-03-19-at-9.01.25-am.png"
        data-srcset="http://blog.kevinyang.net/2020/07/30/docker-101-note-1/screen-shot-2020-03-19-at-9.01.25-am.png, http://blog.kevinyang.net/2020/07/30/docker-101-note-1/screen-shot-2020-03-19-at-9.01.25-am.png 1.5x, http://blog.kevinyang.net/2020/07/30/docker-101-note-1/screen-shot-2020-03-19-at-9.01.25-am.png 2x"
        data-sizes="auto"
        alt="http://blog.kevinyang.net/2020/07/30/docker-101-note-1/screen-shot-2020-03-19-at-9.01.25-am.png"
        title="docker image1" /></p>
<p><strong>镜像（image）</strong>：
docker镜像类似于一个模板，可以通过这个模板来创建容器服务，xxx镜像-&gt;run-&gt;xxx01容器（提供服务器），通过这个镜像可以创建多个容器（最终服务运行或者项目运行就是在容器中的）</p>
<p><strong>容器（container）</strong>：
Docker利用容器技术，独立运行一个或者一组应用，通过镜像来创建的
启动，停止，删除（基本命令）</p>
<p><strong>仓库（repository）</strong>：
类似于github，国外有dockerhub，国内阿里云等需要配置镜像加速</p>
<h1 id="install-docker">install Docker</h1>
<p>我这里是将docker安装到云服务器上，相关下载帮助文档如图所示</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tva3.sinaimg.cn/large/007Z9xVHgy1h68d0unaraj30hk11hqdx.jpg"
        data-srcset="https://tva3.sinaimg.cn/large/007Z9xVHgy1h68d0unaraj30hk11hqdx.jpg, https://tva3.sinaimg.cn/large/007Z9xVHgy1h68d0unaraj30hk11hqdx.jpg 1.5x, https://tva3.sinaimg.cn/large/007Z9xVHgy1h68d0unaraj30hk11hqdx.jpg 2x"
        data-sizes="auto"
        alt="https://tva3.sinaimg.cn/large/007Z9xVHgy1h68d0unaraj30hk11hqdx.jpg"
        title="docker doc" /></p>
<p>网速堪忧，最好提前在服务器部署clash</p>
<h2 id="系统版本">系统版本</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">$ cat /etc/os-release
<span class="nv">NAME</span><span class="o">=</span><span class="s2">&#34;Ubuntu&#34;</span>
<span class="nv">VERSION</span><span class="o">=</span><span class="s2">&#34;20.04 LTS (Focal Fossa)&#34;</span>
<span class="nv">ID</span><span class="o">=</span>ubuntu
<span class="nv">ID_LIKE</span><span class="o">=</span>debian
<span class="nv">PRETTY_NAME</span><span class="o">=</span><span class="s2">&#34;Ubuntu 20.04 LTS&#34;</span>
<span class="nv">VERSION_ID</span><span class="o">=</span><span class="s2">&#34;20.04&#34;</span>
<span class="nv">HOME_URL</span><span class="o">=</span><span class="s2">&#34;https://www.ubuntu.com/&#34;</span>
<span class="nv">SUPPORT_URL</span><span class="o">=</span><span class="s2">&#34;https://help.ubuntu.com/&#34;</span>
<span class="nv">BUG_REPORT_URL</span><span class="o">=</span><span class="s2">&#34;https://bugs.launchpad.net/ubuntu/&#34;</span>
<span class="nv">PRIVACY_POLICY_URL</span><span class="o">=</span><span class="s2">&#34;https://www.ubuntu.com/legal/terms-and-policies/privacy-policy&#34;</span>
<span class="nv">VERSION_CODENAME</span><span class="o">=</span>focal
<span class="nv">UBUNTU_CODENAME</span><span class="o">=</span>focal
</code></pre></td></tr></table>
</div>
</div><h2 id="帮助文档ubuntu">帮助文档（ubuntu）：</h2>
<p><a href="https://docs.docker.com/engine/install/ubuntu/">https://docs.docker.com/engine/install/ubuntu/</a></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="c1"># uninstall old versions</span>
sudo apt-get remove docker docker-engine docker.io containerd runc
</code></pre></td></tr></table>
</div>
</div><h2 id="install-using-the-repository">install using the repository</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="c1"># set up the repository</span>

<span class="c1"># update some packages</span>
sudo apt-get update
sudo apt-get install <span class="se">\
</span><span class="se"></span>    ca-certificates <span class="se">\
</span><span class="se"></span>        curl <span class="se">\
</span><span class="se"></span>            gnupg <span class="se">\
</span><span class="se"></span>                lsb-release
<span class="c1"># add Docker&#39;s official GPG key</span>
sudo mkdir -p /etc/apt/keyrings
curl -fsSL https://download.docker.com/linux/ubuntu/gpg <span class="p">|</span> sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg
<span class="c1"># set up the repository</span>
<span class="nb">echo</span> <span class="se">\
</span><span class="se"></span>  <span class="s2">&#34;deb [arch=</span><span class="k">$(</span>dpkg --print-architecture<span class="k">)</span><span class="s2"> signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/ubuntu \
</span><span class="s2">  </span><span class="k">$(</span>lsb_release -cs<span class="k">)</span><span class="s2"> stable&#34;</span> <span class="p">|</span> sudo tee /etc/apt/sources.list.d/docker.list &gt; /dev/null
</code></pre></td></tr></table>
</div>
</div><p>只要没有报错就成功</p>
<h2 id="设置阿里云镜像软件源">设置阿里云镜像软件源</h2>
<p><strong>这里的设置和上面紧挨着的&rsquo;# set up the repository'冲突，选择其一即可</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="c1"># 安装add-apt-repository</span>
sudo apt update
sudo apt install software-properties-common
<span class="c1"># 设置镜像软件源</span>
sudo add-apt-repository <span class="s2">&#34;deb [arch=amd64] http://mirrors.aliyun.com/docker-ce/linux/ubuntu </span><span class="k">$(</span>lsb_release -cs<span class="k">)</span><span class="s2"> stable&#34;</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="install-docker-engine">install Docker Engine</h2>
<p>(ce社区版，ee企业版)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">sudo apt-get update
sudo apt-get install docker-ce docker-ce-cli containerd.io docker-compose-plugin
</code></pre></td></tr></table>
</div>
</div><p>(如果网络不好，下载超级慢)</p>
<p>(第二遍跟着这个路径走，就算设置了镜像也很慢~)</p>
<h2 id="启动docker">启动docker</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">$ sudo systemctl start docker
$ sudo docker version
Client: Docker Engine - Community
 Version:           20.10.18
 API version:       1.41
 Go version:        go1.18.6
 Git commit:        b40c2f6
 Built:             Thu Sep  <span class="m">8</span> 23:11:45 <span class="m">2022</span>
 OS/Arch:           linux/amd64
 Context:           default
 Experimental:      <span class="nb">true</span>

Server: Docker Engine - Community
 Engine:
  Version:          20.10.18
  API version:      1.41 <span class="o">(</span>minimum version 1.12<span class="o">)</span>
  Go version:       go1.18.6
  Git commit:       e42327a
  Built:            Thu Sep  <span class="m">8</span> 23:09:37 <span class="m">2022</span>
  OS/Arch:          linux/amd64
  Experimental:     <span class="nb">false</span>
 containerd:
  Version:          1.6.8
  GitCommit:        9cd3357b7fd7218e4aec3eae239db1f68a5a6ec6
 runc:
  Version:          1.1.4
  GitCommit:        v1.1.4-0-g5fd4c4d
 docker-init:
  Version:          0.19.0
  GitCommit:        de40ad0
</code></pre></td></tr></table>
</div>
</div><h2 id="测试hello-world">测试hello-world</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">$ sudo docker run hello-world
Unable to find image <span class="s1">&#39;hello-world:latest&#39;</span> locally
latest: Pulling from library/hello-world
2db29710123e: Pull <span class="nb">complete</span>
Digest: sha256:62af9efd515a25f84961b70f973a798d2eca956b1b2b026d0a4a63a3b0b6a3f2
Status: Downloaded newer image <span class="k">for</span> hello-world:latest

Hello from Docker!
This message shows that your installation appears to be working correctly.

To generate this message, Docker took the following steps:
 1. The Docker client contacted the Docker daemon.
 2. The Docker daemon pulled the <span class="s2">&#34;hello-world&#34;</span> image from the Docker Hub.
    <span class="o">(</span>amd64<span class="o">)</span>
 3. The Docker daemon created a new container from that image which runs the
    executable that produces the output you are currently reading.
 4. The Docker daemon streamed that output to the Docker client, which sent it
    to your terminal.

To try something more ambitious, you can run an Ubuntu container with:
 $ docker run -it ubuntu bash

Share images, automate workflows, and more with a free Docker ID:
 https://hub.docker.com/

For more examples and ideas, visit:
 https://docs.docker.com/get-started/
</code></pre></td></tr></table>
</div>
</div><h2 id="查看已有镜像列表">查看已有镜像列表</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">$ sudo docker images
REPOSITORY    TAG       IMAGE ID       CREATED         SIZE
hello-world   latest    feb5d9fea6a5   <span class="m">11</span> months ago   13.3kB
</code></pre></td></tr></table>
</div>
</div><h1 id="卸载docker">卸载Docker</h1>
<p>1、Uninstall the Docker Engine, CLI, Containerd, and Docker Compose packages:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">sudo apt-get purge docker-ce docker-ce-cli containerd.io docker-compose-plugin
</code></pre></td></tr></table>
</div>
</div><p>2、Images, containers, volumes, or customized configuration files on your host are not automatically removed. To delete all images, containers, and volumes:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">sudo rm -rf /var/lib/docker
sudo rm -rf /var/lib/containerd
</code></pre></td></tr></table>
</div>
</div><h1 id="docker的常用命令">Docker的常用命令</h1>
<p>ps.后面一定位置开始我嫌麻烦，所以将<code>sudo docker</code>简写为<code>sdr</code></p>
<h2 id="帮助命令">帮助命令</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">docker version   <span class="c1"># 显示docker的版本信息</span>
docker info      <span class="c1"># 显示docker的系统信息，包括镜像和容器的数量</span>
docker &lt;command&gt; --help  <span class="c1"># 帮助命令</span>
</code></pre></td></tr></table>
</div>
</div><p>帮助文档的地址：https://docs.docker.com/reference/</p>
<h2 id="镜像命令">镜像命令</h2>
<p><strong>docker images</strong>查看所有本地主机上的镜像</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">$ sudo docker images
REPOSITORY    TAG       IMAGE ID       CREATED         SIZE
hello-world   latest    feb5d9fea6a5   <span class="m">11</span> months ago   13.3kB

<span class="c1"># 解释</span>
REPOSITORY  镜像的仓库源
TAG         镜像的标签
IMAGE ID    镜像的id
CREATED     镜像的创建时间
SIZE        镜像的大小

<span class="c1"># 可选项</span>
  -a, --all     <span class="c1"># 列出所有镜像</span>
  -q, --quiet   <span class="c1"># 只显示镜像的id</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>docker search</strong>搜索镜像</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">$ sudo docker search mysql
NAME                            DESCRIPTION                                     STARS     OFFICIAL   AUTOMATED
mysql                           MySQL is a widely used, open-source relation…   <span class="m">13187</span>     <span class="o">[</span>OK<span class="o">]</span>
mariadb                         MariaDB Server is a high performing open sou…   <span class="m">5040</span>      <span class="o">[</span>OK<span class="o">]</span>

$ sudo docker search mysql --filter<span class="o">=</span><span class="nv">STARS</span><span class="o">=</span><span class="m">3000</span>  <span class="c1">#搜索stars不少于3000的镜像</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>docker pull</strong>下载镜像</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="c1"># 下载镜像 docker pull 镜像名[:tag]</span>
$ sudo docker pull mysql
Using default tag: latest <span class="c1"># 如果不写 tag，默认就是 latest</span>
latest: Pulling from library/mysql
051f419db9dd: Pull <span class="nb">complete</span> <span class="c1"># 分层下载，docker image的核心 联合文件系统</span>
7627573fa82a: Pull <span class="nb">complete</span>
a44b358d7796: Pull <span class="nb">complete</span>
95753aff4b95: Pull <span class="nb">complete</span>
a1fa3bee53f4: Pull <span class="nb">complete</span>
f5227e0d612c: Pull <span class="nb">complete</span>
b4b4368b1983: Pull <span class="nb">complete</span>
f26212810c32: Pull <span class="nb">complete</span>
d803d4215f95: Pull <span class="nb">complete</span>
d5358a7f7d07: Pull <span class="nb">complete</span>
435e8908cd69: Pull <span class="nb">complete</span>
Digest: sha256:b9532b1edea72b6cee12d9f5a78547bd3812ea5db842566e17f8b33291ed2921 <span class="c1"># 签名（防伪标志）</span>
Status: Downloaded newer image <span class="k">for</span> mysql:latest
docker.io/library/mysql:latest  <span class="c1"># 真实地址</span>

<span class="c1"># 二者等价：</span>
docker pull mysql
docker pull docker.io/library/mysql:latest

<span class="c1"># 指定版本下载</span>
$ sudo docker pull mysql:5.7
5.7: Pulling from library/mysql
9815334b7810: Pull <span class="nb">complete</span>   <span class="c1"># 如果之前下载过某些层，就会显示&#34;Already exists 直接拿过来用而不重新下载</span>
f85cb6fccbfd: Pull <span class="nb">complete</span>
b63612353671: Pull <span class="nb">complete</span>
447901201612: Pull <span class="nb">complete</span>
9b6bc806cc29: Pull <span class="nb">complete</span>
24ec1f4b3b0d: Pull <span class="nb">complete</span>
207ed1eb2fd4: Pull <span class="nb">complete</span>
27cbde3edd97: Pull <span class="nb">complete</span>
0a5aa35cc154: Pull <span class="nb">complete</span>
e6c92bf6471b: Pull <span class="nb">complete</span>
07b80de0d1af: Pull <span class="nb">complete</span>
Digest: sha256:c1bda6ecdbc63d3b0d3a3a3ce195de3dd755c4a0658ed782a16a0682216b9a48
Status: Downloaded newer image <span class="k">for</span> mysql:5.7
docker.io/library/mysql:5.7
</code></pre></td></tr></table>
</div>
</div><p><strong>docker rmi</strong>删除镜像
docker rmi -f 镜像id [镜像id] [镜像id] &hellip;</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">$ sudo docker images
REPOSITORY    TAG       IMAGE ID       CREATED         SIZE
mysql         latest    43fcfca0776d   <span class="m">35</span> hours ago    449MB
mysql         5.7       daff57b7d2d1   <span class="m">3</span> weeks ago     430MB
hello-world   latest    feb5d9fea6a5   <span class="m">11</span> months ago   13.3kB
$ sudo docker rmi -f daff57b7d2d1 <span class="c1"># 根据id删除镜像</span>
Untagged: mysql:5.7
Untagged: mysql@sha256:c1bda6ecdbc63d3b0d3a3a3ce195de3dd755c4a0658ed782a16a0682216b9a48
Deleted: sha256:daff57b7d2d1e009d0b271972f62dbf4de64b8cdb9cd646442aeda961e615f44
Deleted: sha256:a2b6de0d8fad38b5d19b0207decce5994598e15ae6aaf974733924dcbd8f04de
Deleted: sha256:f3bd23ad30ca816481c810885546988744e444e8b4f52c196c29d5e3f667157f
Deleted: sha256:7789a0eac346070602d9fae747fb5d81952454c6e11d5381cbc12a4825198d6e
Deleted: sha256:2cdfa876efe3302b715dad6bfd13cee0c512c58843200920953efe3355f5931c
Deleted: sha256:8d4cf9ffb69b960e2a2ebb157660b37a15ea645a71791aefc2b1600f1f603ebb
Deleted: sha256:d98069632a6bb3b2ba690a11cff2481a9b954aba58a7c3388484dd65ef8e1580
Deleted: sha256:0295feed0657a087e23700dcf0e41069bf8c565a092eea9426be99d8de5a45dc
Deleted: sha256:c9a9086bbafa8383c2002a50cce49e22bd060897dc121c18b41a9893b83816f5
Deleted: sha256:ed4bd9721438e36a8667ddcb461b958473d7b5f155df32155e08764648486087
Deleted: sha256:018f336482437233f5c9e135a18f5ba391448340d3ef2ec99fd88ab599906463
Deleted: sha256:bcf2a1ad6472a891de95b5132d013c064a07ec9995cb61b0cc0f8d4a4ea855fb

$ sudo docker rmi -f <span class="k">$(</span>sudo docker images -aq<span class="k">)</span> <span class="c1"># $()传入多个参数，这里传入所有镜像的id然后删除</span>
Untagged: mysql:latest
Untagged: mysql@sha256:b9532b1edea72b6cee12d9f5a78547bd3812ea5db842566e17f8b33291ed2921
Deleted: sha256:43fcfca0776df8e192d1647da2866237fbd9f8e875fb496e4ca887369b2dd995
Deleted: sha256:45d11760ca3e62bb36a589002b413a42c60c9b917b7a089b116c1ab69155aa4d
Deleted: sha256:af1876abdf5bbbef0ac13e24068669d600bf7de8aa74f31a43ae5f56b83331c2
Deleted: sha256:e1668f1334215580aa7a19beef5d1ee6c6ba121c305154f1ddd7253e21bf65e8
Deleted: sha256:91d92a76bd6a29d88aa511715731ac59d1df33c8e4f5b393dbc16c16b9c08b1c
Deleted: sha256:8608eb76a683654e96af6087a19f416c4498e46f1121e15d63d2ce983750a3a2
Deleted: sha256:fd95c084aad87623a6db2c76480f0765e16ae2ba6de68ce1aefdb7ea4e8fe120
Deleted: sha256:968e68a28e13606ce58651654f554c342f51d5f3ea7e792cdcb21809fefe1a4f
Deleted: sha256:15628dda9c1556632ae3577f5dd8ff16c6456fb95da60284783e8c1f89c588ae
Deleted: sha256:49904d4d7d64ce4a3b64466e4d9bdc624fa8acc760c6a622dcbde03a0ada9fed
Deleted: sha256:df0e3d67e1ecb153c572e3110d36a8bbc46ded2dc376395384c6171732241d90
Deleted: sha256:05dc728e5e49b5db657ec403b875f757afdd8d31f624eea76d706d6eee6395b2
Untagged: hello-world:latest
Untagged: hello-world@sha256:62af9efd515a25f84961b70f973a798d2eca956b1b2b026d0a4a63a3b0b6a3f2
Deleted: sha256:feb5d9fea6a5e9606aa995e879d862b825965ba48de054caab5ef356dc6b3412
</code></pre></td></tr></table>
</div>
</div><h2 id="容器命令">容器命令</h2>
<ul>
<li>有了镜像才可以创建容器，linux，下载一个centos镜像:<code>docker pull centos</code></li>
</ul>
<p><strong>新建容器并启动</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">docker run <span class="o">[</span>可选参数<span class="o">]</span> image

<span class="c1"># 参数说明</span>
--name<span class="o">=</span><span class="s2">&#34;Name&#34;</span>   <span class="c1"># 容器名字 区分容器</span>
-d          <span class="c1"># 后台方式运行（linux本身是nohup）</span>
-it         <span class="c1"># 使用交互方式运行，进入容器查看内容</span>
-p          <span class="c1"># 指定容器的端口 -p 8080:8080</span>
  -p ip:主机端口:容器端口
  -p 主机端口:容器端口
  -p 容器端口
  容器端口
-P          <span class="c1"># 随机指定端口</span>

<span class="c1"># 测试，启动并进入容器</span>
$ sudo docker run -it centos /bin/bash
<span class="o">[</span>root@f4373afebe37 /<span class="o">]</span><span class="c1"># ls # 查看容器内的centos，基础版本，很多命令不完善</span>
bin  etc   lib    lost+found  mnt  proc  run   srv  tmp  var
dev  home  lib64  media       opt  root  sbin  sys  usr

<span class="c1"># 从容器中退回主机</span>
<span class="o">[</span>root@f4373afebe37 /<span class="o">]</span><span class="c1"># exit</span>
<span class="nb">exit</span>
$ ls
blog  clash
</code></pre></td></tr></table>
</div>
</div><p><strong>列出所有运行中容器</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="c1"># docker ps 命令</span>
    <span class="c1"># 列出当前正在运行的容器</span>
-a    <span class="c1"># 列出当前正在运行的容器+带出历史运行过的容器</span>
-n<span class="o">=</span>?  <span class="c1"># 显示最近创建的容器</span>
-q    <span class="c1"># 只显示容器的编号</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>退出容器</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="nb">exit</span>  <span class="c1"># 直接容器停止并退出</span>
CTRL + P + Q  <span class="c1"># 容器不停止退出</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>删除容器</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">docker rm 容器id          <span class="c1"># 删除指定容器，不能删除正在运行的容器</span>
docker rm -f <span class="k">$(</span>docker ps -aq<span class="k">)</span> <span class="c1"># 删除所有容器</span>
docker ps -aq <span class="p">|</span> xargs docker rm <span class="c1"># 删除所有容器</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>启动和停止容器</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">docker start 容器id   <span class="c1"># 启动容器</span>
docker restart 容器id   <span class="c1"># 重启容器</span>
docker stop 容器id    <span class="c1"># 停止当前正在运行的容器</span>
docker <span class="nb">kill</span> 容器id    <span class="c1"># 强制停止容器</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="常用其他命令">常用其他命令</h2>
<p><strong>后台启动容器</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="c1"># 命令 docker run -d 镜像名</span>
$ sudo docker run -d centos

<span class="c1"># docker ps 发现centos停止了</span>

<span class="c1"># 常见的坑，docker 容器使用后台运行，就必须要有一个前台进程，docker发现没有应用，就会自动停止</span>
<span class="c1"># nginx，容器启动后，发现自己没有提供服务，就会立刻停止，就是没有程序了</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>查看日志</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">docker logs -f -t --tail &lt;num&gt; 容器id
<span class="c1"># 空挂容器会导致关机或者logs为空</span>
<span class="c1"># 后台开启一个容器并运行一个脚本</span>
$ sudo docker run -d centos /bin/sh -c <span class="s2">&#34;while true;do echo hello;sleep 1;done&#34;</span>

<span class="c1"># 显示日志</span>
-tf     <span class="c1"># 显示所有日志，t时间戳，f持续输出</span>
-tail number# 要显示的日志条数
$ sudo docker logs -ft --tail <span class="m">10</span> 2cb886ae2fa9 <span class="c1"># 10为日志条数，由于加了参数f，会持续输出日志</span>
2022-09-16T10:33:50.928401034Z hello
2022-09-16T10:33:51.930308966Z hello
2022-09-16T10:33:52.932148793Z hello
2022-09-16T10:33:53.933995843Z hello
</code></pre></td></tr></table>
</div>
</div><p><strong>查看容器中的进程信息</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="c1"># 命令 docker top 容器id</span>
$ sudo docker top 2cb886ae2fa9
UID                 PID                 PPID                C                   STIME               TTY                 TIME                CMD
root                <span class="m">162268</span>              <span class="m">162248</span>              <span class="m">0</span>                   18:32               ? 
root                <span class="m">164167</span>              <span class="m">162268</span>              <span class="m">0</span>                   18:40               ? 
</code></pre></td></tr></table>
</div>
</div><p><strong>查看镜像的元数据</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span><span class="lnt">194
</span><span class="lnt">195
</span><span class="lnt">196
</span><span class="lnt">197
</span><span class="lnt">198
</span><span class="lnt">199
</span><span class="lnt">200
</span><span class="lnt">201
</span><span class="lnt">202
</span><span class="lnt">203
</span><span class="lnt">204
</span><span class="lnt">205
</span><span class="lnt">206
</span><span class="lnt">207
</span><span class="lnt">208
</span><span class="lnt">209
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="c1"># 命令 docker inspect 容器id</span>

$ sudo docker inspect 2cb886ae2fa9
<span class="o">[</span>
    <span class="o">{</span>
        <span class="s2">&#34;Id&#34;</span>: <span class="s2">&#34;2cb886ae2fa927bc1bca61010b04a97f3aadf0a5e0d830c98dca6a920278017e&#34;</span>,
        <span class="s2">&#34;Created&#34;</span>: <span class="s2">&#34;2022-09-16T10:32:21.383810621Z&#34;</span>,
        <span class="s2">&#34;Path&#34;</span>: <span class="s2">&#34;/bin/sh&#34;</span>,
        <span class="s2">&#34;Args&#34;</span>: <span class="o">[</span>
            <span class="s2">&#34;-c&#34;</span>,
            <span class="s2">&#34;while true;do echo hello;sleep 1;done&#34;</span>
        <span class="o">]</span>,
        <span class="s2">&#34;State&#34;</span>: <span class="o">{</span>
            <span class="s2">&#34;Status&#34;</span>: <span class="s2">&#34;running&#34;</span>,
            <span class="s2">&#34;Running&#34;</span>: true,
            <span class="s2">&#34;Paused&#34;</span>: false,
            <span class="s2">&#34;Restarting&#34;</span>: false,
            <span class="s2">&#34;OOMKilled&#34;</span>: false,
            <span class="s2">&#34;Dead&#34;</span>: false,
            <span class="s2">&#34;Pid&#34;</span>: 162268,
            <span class="s2">&#34;ExitCode&#34;</span>: 0,
            <span class="s2">&#34;Error&#34;</span>: <span class="s2">&#34;&#34;</span>,
            <span class="s2">&#34;StartedAt&#34;</span>: <span class="s2">&#34;2022-09-16T10:32:21.762354014Z&#34;</span>,
            <span class="s2">&#34;FinishedAt&#34;</span>: <span class="s2">&#34;0001-01-01T00:00:00Z&#34;</span>
        <span class="o">}</span>,
        <span class="s2">&#34;Image&#34;</span>: <span class="s2">&#34;sha256:5d0da3dc976460b72c77d94c8a1ad043720b0416bfc16c52c45d4847e53fadb6&#34;</span>,
        <span class="s2">&#34;ResolvConfPath&#34;</span>: <span class="s2">&#34;/var/lib/docker/containers/2cb886ae2fa927bc1bca61010b04a97f3aadf0a5e0d830c98dca6a920278017e/resolv.conf&#34;</span>,        <span class="s2">&#34;HostnamePath&#34;</span>: <span class="s2">&#34;/var/lib/docker/containers/2cb886ae2fa927bc1bca61010b04a97f3aadf0a5e0d830c98dca6a920278017e/hostname&#34;</span>,
        <span class="s2">&#34;HostsPath&#34;</span>: <span class="s2">&#34;/var/lib/docker/containers/2cb886ae2fa927bc1bca61010b04a97f3aadf0a5e0d830c98dca6a920278017e/hosts&#34;</span>,
        <span class="s2">&#34;LogPath&#34;</span>: <span class="s2">&#34;/var/lib/docker/containers/2cb886ae2fa927bc1bca61010b04a97f3aadf0a5e0d830c98dca6a920278017e/2cb886ae2fa927bc1bca61010b04a97f3aadf0a5e0d830c98dca6a920278017e-json.log&#34;</span>,
        <span class="s2">&#34;Name&#34;</span>: <span class="s2">&#34;/festive_mclaren&#34;</span>,
        <span class="s2">&#34;RestartCount&#34;</span>: 0,
        <span class="s2">&#34;Driver&#34;</span>: <span class="s2">&#34;overlay2&#34;</span>,
        <span class="s2">&#34;Platform&#34;</span>: <span class="s2">&#34;linux&#34;</span>,
        <span class="s2">&#34;MountLabel&#34;</span>: <span class="s2">&#34;&#34;</span>,
        <span class="s2">&#34;ProcessLabel&#34;</span>: <span class="s2">&#34;&#34;</span>,
        <span class="s2">&#34;AppArmorProfile&#34;</span>: <span class="s2">&#34;docker-default&#34;</span>,
        <span class="s2">&#34;ExecIDs&#34;</span>: null,
        <span class="s2">&#34;HostConfig&#34;</span>: <span class="o">{</span>
            <span class="s2">&#34;Binds&#34;</span>: null,
            <span class="s2">&#34;ContainerIDFile&#34;</span>: <span class="s2">&#34;&#34;</span>,
            <span class="s2">&#34;LogConfig&#34;</span>: <span class="o">{</span>
                <span class="s2">&#34;Type&#34;</span>: <span class="s2">&#34;json-file&#34;</span>,
                <span class="s2">&#34;Config&#34;</span>: <span class="o">{}</span>
            <span class="o">}</span>,
            <span class="s2">&#34;NetworkMode&#34;</span>: <span class="s2">&#34;default&#34;</span>,
            <span class="s2">&#34;PortBindings&#34;</span>: <span class="o">{}</span>,
            <span class="s2">&#34;RestartPolicy&#34;</span>: <span class="o">{</span>
                <span class="s2">&#34;Name&#34;</span>: <span class="s2">&#34;no&#34;</span>,
                <span class="s2">&#34;MaximumRetryCount&#34;</span>: <span class="m">0</span>
            <span class="o">}</span>,
            <span class="s2">&#34;AutoRemove&#34;</span>: false,
            <span class="s2">&#34;VolumeDriver&#34;</span>: <span class="s2">&#34;&#34;</span>,
            <span class="s2">&#34;VolumesFrom&#34;</span>: null,
            <span class="s2">&#34;CapAdd&#34;</span>: null,
            <span class="s2">&#34;CapDrop&#34;</span>: null,
            <span class="s2">&#34;CgroupnsMode&#34;</span>: <span class="s2">&#34;host&#34;</span>,
            <span class="s2">&#34;Dns&#34;</span>: <span class="o">[]</span>,
            <span class="s2">&#34;DnsOptions&#34;</span>: <span class="o">[]</span>,
            <span class="s2">&#34;DnsSearch&#34;</span>: <span class="o">[]</span>,
            <span class="s2">&#34;ExtraHosts&#34;</span>: null,
            <span class="s2">&#34;GroupAdd&#34;</span>: null,
            <span class="s2">&#34;IpcMode&#34;</span>: <span class="s2">&#34;private&#34;</span>,
            <span class="s2">&#34;Cgroup&#34;</span>: <span class="s2">&#34;&#34;</span>,
            <span class="s2">&#34;Links&#34;</span>: null,
            <span class="s2">&#34;OomScoreAdj&#34;</span>: 0,
            <span class="s2">&#34;PidMode&#34;</span>: <span class="s2">&#34;&#34;</span>,
            <span class="s2">&#34;Privileged&#34;</span>: false,
            <span class="s2">&#34;PublishAllPorts&#34;</span>: false,
            <span class="s2">&#34;ReadonlyRootfs&#34;</span>: false,
            <span class="s2">&#34;SecurityOpt&#34;</span>: null,
            <span class="s2">&#34;UTSMode&#34;</span>: <span class="s2">&#34;&#34;</span>,
            <span class="s2">&#34;UsernsMode&#34;</span>: <span class="s2">&#34;&#34;</span>,
            <span class="s2">&#34;ShmSize&#34;</span>: 67108864,
            <span class="s2">&#34;Runtime&#34;</span>: <span class="s2">&#34;runc&#34;</span>,
            <span class="s2">&#34;ConsoleSize&#34;</span>: <span class="o">[</span>
                0,
                <span class="m">0</span>
            <span class="o">]</span>,
            <span class="s2">&#34;Isolation&#34;</span>: <span class="s2">&#34;&#34;</span>,
            <span class="s2">&#34;CpuShares&#34;</span>: 0,
            <span class="s2">&#34;Memory&#34;</span>: 0,
            <span class="s2">&#34;NanoCpus&#34;</span>: 0,
            <span class="s2">&#34;CgroupParent&#34;</span>: <span class="s2">&#34;&#34;</span>,
            <span class="s2">&#34;BlkioWeight&#34;</span>: 0,
            <span class="s2">&#34;BlkioWeightDevice&#34;</span>: <span class="o">[]</span>,
            <span class="s2">&#34;BlkioDeviceReadBps&#34;</span>: null,
            <span class="s2">&#34;BlkioDeviceWriteBps&#34;</span>: null,
            <span class="s2">&#34;BlkioDeviceReadIOps&#34;</span>: null,
            <span class="s2">&#34;BlkioDeviceWriteIOps&#34;</span>: null,
            <span class="s2">&#34;CpuPeriod&#34;</span>: 0,
            <span class="s2">&#34;CpuQuota&#34;</span>: 0,
            <span class="s2">&#34;CpuRealtimePeriod&#34;</span>: 0,
            <span class="s2">&#34;CpuRealtimeRuntime&#34;</span>: 0,
            <span class="s2">&#34;CpusetCpus&#34;</span>: <span class="s2">&#34;&#34;</span>,
            <span class="s2">&#34;CpusetMems&#34;</span>: <span class="s2">&#34;&#34;</span>,
            <span class="s2">&#34;Devices&#34;</span>: <span class="o">[]</span>,
            <span class="s2">&#34;DeviceCgroupRules&#34;</span>: null,
            <span class="s2">&#34;DeviceRequests&#34;</span>: null,
            <span class="s2">&#34;KernelMemory&#34;</span>: 0,
            <span class="s2">&#34;KernelMemoryTCP&#34;</span>: 0,
            <span class="s2">&#34;MemoryReservation&#34;</span>: 0,
            <span class="s2">&#34;MemorySwap&#34;</span>: 0,
            <span class="s2">&#34;MemorySwappiness&#34;</span>: null,
            <span class="s2">&#34;OomKillDisable&#34;</span>: false,
            <span class="s2">&#34;PidsLimit&#34;</span>: null,
            <span class="s2">&#34;Ulimits&#34;</span>: null,
            <span class="s2">&#34;CpuCount&#34;</span>: 0,
            <span class="s2">&#34;CpuPercent&#34;</span>: 0,
            <span class="s2">&#34;IOMaximumIOps&#34;</span>: 0,
            <span class="s2">&#34;IOMaximumBandwidth&#34;</span>: 0,
            <span class="s2">&#34;MaskedPaths&#34;</span>: <span class="o">[</span>
                <span class="s2">&#34;/proc/asound&#34;</span>,
                <span class="s2">&#34;/proc/acpi&#34;</span>,
                <span class="s2">&#34;/proc/kcore&#34;</span>,
                <span class="s2">&#34;/proc/keys&#34;</span>,
                <span class="s2">&#34;/proc/latency_stats&#34;</span>,
                <span class="s2">&#34;/proc/timer_list&#34;</span>,
                <span class="s2">&#34;/proc/timer_stats&#34;</span>,
                <span class="s2">&#34;/proc/sched_debug&#34;</span>,
                <span class="s2">&#34;/proc/scsi&#34;</span>,
                <span class="s2">&#34;/sys/firmware&#34;</span>
            <span class="o">]</span>,
            <span class="s2">&#34;ReadonlyPaths&#34;</span>: <span class="o">[</span>
                <span class="s2">&#34;/proc/bus&#34;</span>,
                <span class="s2">&#34;/proc/fs&#34;</span>,
                <span class="s2">&#34;/proc/irq&#34;</span>,
                <span class="s2">&#34;/proc/sys&#34;</span>,
                <span class="s2">&#34;/proc/sysrq-trigger&#34;</span>
            <span class="o">]</span>
        <span class="o">}</span>,
        <span class="s2">&#34;GraphDriver&#34;</span>: <span class="o">{</span>
            <span class="s2">&#34;Data&#34;</span>: <span class="o">{</span>
                <span class="s2">&#34;LowerDir&#34;</span>: <span class="s2">&#34;/var/lib/docker/overlay2/5e5a494c7a50b728f7118cdcf59378061bfc825810cc1cdda3a61900898f31d3-init/diff:/var/lib/docker/overlay2/67c73992368fc175a0d2849bc97620a48f90ed375eabe859da0816b8eb4b25cd/diff&#34;</span>,
                <span class="s2">&#34;MergedDir&#34;</span>: <span class="s2">&#34;/var/lib/docker/overlay2/5e5a494c7a50b728f7118cdcf59378061bfc825810cc1cdda3a61900898f31d3/merged&#34;</span>,
                <span class="s2">&#34;UpperDir&#34;</span>: <span class="s2">&#34;/var/lib/docker/overlay2/5e5a494c7a50b728f7118cdcf59378061bfc825810cc1cdda3a61900898f31d3/diff&#34;</span>,
                <span class="s2">&#34;WorkDir&#34;</span>: <span class="s2">&#34;/var/lib/docker/overlay2/5e5a494c7a50b728f7118cdcf59378061bfc825810cc1cdda3a61900898f31d3/work&#34;</span>
            <span class="o">}</span>,
            <span class="s2">&#34;Name&#34;</span>: <span class="s2">&#34;overlay2&#34;</span>
        <span class="o">}</span>,
        <span class="s2">&#34;Mounts&#34;</span>: <span class="o">[]</span>,
        <span class="s2">&#34;Config&#34;</span>: <span class="o">{</span>
            <span class="s2">&#34;Hostname&#34;</span>: <span class="s2">&#34;2cb886ae2fa9&#34;</span>,
            <span class="s2">&#34;Domainname&#34;</span>: <span class="s2">&#34;&#34;</span>,
            <span class="s2">&#34;User&#34;</span>: <span class="s2">&#34;&#34;</span>,
            <span class="s2">&#34;AttachStdin&#34;</span>: false,
            <span class="s2">&#34;AttachStdout&#34;</span>: false,
            <span class="s2">&#34;AttachStderr&#34;</span>: false,
            <span class="s2">&#34;Tty&#34;</span>: false,
            <span class="s2">&#34;OpenStdin&#34;</span>: false,
            <span class="s2">&#34;StdinOnce&#34;</span>: false,
            <span class="s2">&#34;Env&#34;</span>: <span class="o">[</span>
                <span class="s2">&#34;PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&#34;</span>
            <span class="o">]</span>,
            <span class="s2">&#34;Cmd&#34;</span>: <span class="o">[</span>
                <span class="s2">&#34;/bin/sh&#34;</span>,
                <span class="s2">&#34;-c&#34;</span>,
                <span class="s2">&#34;while true;do echo hello;sleep 1;done&#34;</span>
            <span class="o">]</span>,
            <span class="s2">&#34;Image&#34;</span>: <span class="s2">&#34;centos&#34;</span>,
            <span class="s2">&#34;Volumes&#34;</span>: null,
            <span class="s2">&#34;WorkingDir&#34;</span>: <span class="s2">&#34;&#34;</span>,
            <span class="s2">&#34;Entrypoint&#34;</span>: null,
            <span class="s2">&#34;OnBuild&#34;</span>: null,
            <span class="s2">&#34;Labels&#34;</span>: <span class="o">{</span>
                <span class="s2">&#34;org.label-schema.build-date&#34;</span>: <span class="s2">&#34;20210915&#34;</span>,
                <span class="s2">&#34;org.label-schema.license&#34;</span>: <span class="s2">&#34;GPLv2&#34;</span>,
                <span class="s2">&#34;org.label-schema.name&#34;</span>: <span class="s2">&#34;CentOS Base Image&#34;</span>,
                <span class="s2">&#34;org.label-schema.schema-version&#34;</span>: <span class="s2">&#34;1.0&#34;</span>,
                <span class="s2">&#34;org.label-schema.vendor&#34;</span>: <span class="s2">&#34;CentOS&#34;</span>
            <span class="o">}</span>
        <span class="o">}</span>,
        <span class="s2">&#34;NetworkSettings&#34;</span>: <span class="o">{</span>
            <span class="s2">&#34;Bridge&#34;</span>: <span class="s2">&#34;&#34;</span>,
            <span class="s2">&#34;SandboxID&#34;</span>: <span class="s2">&#34;09f57f62adb9fc11d121a70bd0484a6e49284692ad39d86ba58d6bd52ffac681&#34;</span>,
            <span class="s2">&#34;HairpinMode&#34;</span>: false,
            <span class="s2">&#34;LinkLocalIPv6Address&#34;</span>: <span class="s2">&#34;&#34;</span>,
            <span class="s2">&#34;LinkLocalIPv6PrefixLen&#34;</span>: 0,
            <span class="s2">&#34;Ports&#34;</span>: <span class="o">{}</span>,
            <span class="s2">&#34;SandboxKey&#34;</span>: <span class="s2">&#34;/var/run/docker/netns/09f57f62adb9&#34;</span>,
            <span class="s2">&#34;SecondaryIPAddresses&#34;</span>: null,
            <span class="s2">&#34;SecondaryIPv6Addresses&#34;</span>: null,
            <span class="s2">&#34;EndpointID&#34;</span>: <span class="s2">&#34;4ac1492efb6c8d55fcc381116917dbb3abcfb5bcde25de84f8efd084ccd018cf&#34;</span>,
            <span class="s2">&#34;Gateway&#34;</span>: <span class="s2">&#34;172.17.0.1&#34;</span>,
            <span class="s2">&#34;GlobalIPv6Address&#34;</span>: <span class="s2">&#34;&#34;</span>,
            <span class="s2">&#34;GlobalIPv6PrefixLen&#34;</span>: 0,
            <span class="s2">&#34;IPAddress&#34;</span>: <span class="s2">&#34;172.17.0.2&#34;</span>,
            <span class="s2">&#34;IPPrefixLen&#34;</span>: 16,
            <span class="s2">&#34;IPv6Gateway&#34;</span>: <span class="s2">&#34;&#34;</span>,
            <span class="s2">&#34;MacAddress&#34;</span>: <span class="s2">&#34;02:42:ac:11:00:02&#34;</span>,
            <span class="s2">&#34;Networks&#34;</span>: <span class="o">{</span>
                <span class="s2">&#34;bridge&#34;</span>: <span class="o">{</span>
                    <span class="s2">&#34;IPAMConfig&#34;</span>: null,
                    <span class="s2">&#34;Links&#34;</span>: null,
                    <span class="s2">&#34;Aliases&#34;</span>: null,
                    <span class="s2">&#34;NetworkID&#34;</span>: <span class="s2">&#34;4171a585caf462e0363f1976199c44032198de483e6ec43c17962f490b730c95&#34;</span>,
                    <span class="s2">&#34;EndpointID&#34;</span>: <span class="s2">&#34;4ac1492efb6c8d55fcc381116917dbb3abcfb5bcde25de84f8efd084ccd018cf&#34;</span>,
                    <span class="s2">&#34;Gateway&#34;</span>: <span class="s2">&#34;172.17.0.1&#34;</span>,
                    <span class="s2">&#34;IPAddress&#34;</span>: <span class="s2">&#34;172.17.0.2&#34;</span>,
                    <span class="s2">&#34;IPPrefixLen&#34;</span>: 16,
                    <span class="s2">&#34;IPv6Gateway&#34;</span>: <span class="s2">&#34;&#34;</span>,
                    <span class="s2">&#34;GlobalIPv6Address&#34;</span>: <span class="s2">&#34;&#34;</span>,
                    <span class="s2">&#34;GlobalIPv6PrefixLen&#34;</span>: 0,
                    <span class="s2">&#34;MacAddress&#34;</span>: <span class="s2">&#34;02:42:ac:11:00:02&#34;</span>,
                    <span class="s2">&#34;DriverOpts&#34;</span>: null
                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">]</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>进入当前正在运行的容器</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="c1"># 通常容器都是使用后台方式运行的，需要进入容器，修改一些配置</span>

<span class="c1"># 命令</span>
docker <span class="nb">exec</span> -it 容器id bashshell

$ sdr <span class="nb">exec</span> -it 2cb886ae2fa9 /bin/bash
<span class="o">[</span>root@2cb886ae2fa9 /<span class="o">]</span><span class="c1"># ls</span>
bin  etc   lib    lost+found  mnt  proc  run   srv  tmp  var
dev  home  lib64  media       opt  root  sbin  sys  usr
<span class="o">[</span>root@2cb886ae2fa9 /<span class="o">]</span><span class="c1"># ps -ef</span>
UID          PID    PPID  C STIME TTY          TIME CMD
root           <span class="m">1</span>       <span class="m">0</span>  <span class="m">0</span> 10:32 ?        00:00:00 /bin/sh -c <span class="k">while</span> true<span class="p">;</span><span class="k">do</span>
root        <span class="m">1487</span>       <span class="m">0</span>  <span class="m">0</span> 10:57 pts/0    00:00:00 /bin/bash
root        <span class="m">1519</span>       <span class="m">1</span>  <span class="m">0</span> 10:57 ?        00:00:00 /usr/bin/coreutils --cor
root        <span class="m">1520</span>    <span class="m">1487</span>  <span class="m">0</span> 10:57 pts/0    00:00:00 ps -ef

<span class="c1"># 方式二</span>
docker attach 容器id
$ sudo docker attach thisisanid

<span class="c1"># 区别：</span>
<span class="c1"># exec进入容器后打开了一个新的命令行</span>
<span class="c1"># attach进入容器当前正在执行的终端，不会启动新的进程</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>从容器内拷贝文件到主机上</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">docker cp 容器id:容器内路径 目的主机路径

<span class="c1"># 在容器内新建文件</span>
<span class="o">[</span>root@78e4d3ef944f /<span class="o">]</span><span class="c1"># cd /home</span>
<span class="o">[</span>root@78e4d3ef944f home<span class="o">]</span><span class="c1"># ls</span>
<span class="o">[</span>root@78e4d3ef944f home<span class="o">]</span><span class="c1"># la</span>
bash: la: <span class="nb">command</span> not found
<span class="o">[</span>root@78e4d3ef944f home<span class="o">]</span><span class="c1"># ls -al</span>
total <span class="m">8</span>
drwxr-xr-x <span class="m">2</span> root root <span class="m">4096</span> Nov  <span class="m">3</span>  <span class="m">2020</span> .
drwxr-xr-x <span class="m">1</span> root root <span class="m">4096</span> Sep <span class="m">16</span> 11:09 ..
<span class="o">[</span>root@78e4d3ef944f home<span class="o">]</span><span class="c1"># touch test.md</span>

<span class="c1"># 回到主机，拷贝文件到主机</span>
<span class="o">[</span>root@78e4d3ef944f home<span class="o">]</span><span class="c1"># exit</span>
<span class="nb">exit</span>
$ sdr cp 78e4d3ef944f:/home/test.md /home
$ <span class="nb">cd</span> /home

<span class="c1"># 成功拷贝</span>
$ ls
lighthouse  test.md  ubuntu

<span class="c1"># 拷贝是一个手动过程，可以使用 -v 卷的技术，实现自动同步，即连同内外两个目录</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="小结">小结</h2>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://img-blog.csdnimg.cn/383865dd59f64bd88cbe6b4a56f1315c.png"
        data-srcset="https://img-blog.csdnimg.cn/383865dd59f64bd88cbe6b4a56f1315c.png, https://img-blog.csdnimg.cn/383865dd59f64bd88cbe6b4a56f1315c.png 1.5x, https://img-blog.csdnimg.cn/383865dd59f64bd88cbe6b4a56f1315c.png 2x"
        data-sizes="auto"
        alt="https://img-blog.csdnimg.cn/383865dd59f64bd88cbe6b4a56f1315c.png"
        title="summary" /></p>
<h2 id="练习">练习</h2>
<h3 id="nginx">nginx</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">sdr pull nginx
sdr run -d --name nginx-test -p 7788:80 nginx
curl localhost:7788
</code></pre></td></tr></table>
</div>
</div><p>pull nginx镜像
启动一个容器
curl本地7788端口</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="c">&lt;!--返回以下网页--&gt;</span>
<span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Welcome to nginx!<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">style</span><span class="p">&gt;</span>
<span class="nt">html</span> <span class="p">{</span> <span class="n">color-scheme</span><span class="p">:</span> <span class="n">light</span> <span class="n">dark</span><span class="p">;</span> <span class="p">}</span>
<span class="nt">body</span> <span class="p">{</span> <span class="k">width</span><span class="p">:</span> <span class="mi">35</span><span class="kt">em</span><span class="p">;</span> <span class="k">margin</span><span class="p">:</span> <span class="mi">0</span> <span class="kc">auto</span><span class="p">;</span>
<span class="k">font-family</span><span class="p">:</span> <span class="n">Tahoma</span><span class="p">,</span> <span class="n">Verdana</span><span class="p">,</span> <span class="n">Arial</span><span class="p">,</span> <span class="kc">sans-serif</span><span class="p">;</span> <span class="p">}</span>
<span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>Welcome to nginx!<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>If you see this page, the nginx web server is successfully installed and
working. Further configuration is required.<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>For online documentation and support please refer to
<span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;http://nginx.org/&#34;</span><span class="p">&gt;</span>nginx.org<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>.<span class="p">&lt;</span><span class="nt">br</span><span class="p">/&gt;</span>
Commercial support is available at
<span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;http://nginx.com/&#34;</span><span class="p">&gt;</span>nginx.com<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>.<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;&lt;</span><span class="nt">em</span><span class="p">&gt;</span>Thank you for using nginx.<span class="p">&lt;/</span><span class="nt">em</span><span class="p">&gt;&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>外网通过7788端口访问到Linux，然后通过<code>-p 7788:80</code>将7788端口接入容器80端口，从而访问nginx</p>
<h3 id="tomcat">tomcat</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">sdr pull tomcat
sdr run -d -p 6677:8080 --name tomcat-test tomcat
</code></pre></td></tr></table>
</div>
</div><p>通过公网ip访问发现404（还是能访问的，只不过是404）</p>
<p><code>sdr exec -it tomcat-test /bin/bash</code>进入容器，发现webapps为空</p>
<p><code>cp -r webapps.dist/* webapps</code>把实例文档拷贝进去</p>
<p>再次访问公网ip:6677发现成功显示页面</p>
<h1 id="docker镜像讲解">Docker镜像讲解</h1>
<h2 id="镜像是什么">镜像是什么</h2>
<p>镜像是一种轻量级、可执行的独立软件包，用来打包软件运行环境和基于运行环境开发的软件，它包含运行某个软件所需的所有内容，包括代码、运行时的库、环境变量和配置文件。</p>
<p>所有的应用，直接打包docker镜像，就可以直接跑起来</p>
<p>如何得到镜像：</p>
<ul>
<li>从远程仓库下载</li>
<li>手动拷贝</li>
<li>自己制作一个镜像DockerFile</li>
</ul>
<h2 id="docker镜像加载原理">Docker镜像加载原理</h2>
<blockquote>
<p>UnionFS（联合文件系统）</p>
</blockquote>
<p>下载的时候看到的一层层的就是这个</p>
<p>UnionFS（联合文件系统）：Union文件系统是一种分层、轻量级并且高性能的文件系统，它支持对文件系统的修改作为一次提交来一层层的叠加，同时可以将不同目录挂载到同一个虚拟文件系统下(unite several directories into a single virtual filesystem)。Union文件系统时Docker镜像的基础。镜像可以通过分层来进行集成，基于基础镜像（没有父镜像），可以制作各种具体的应用镜像。</p>
<p>特性：一次同时加载多个文件系统，但从外面看起来，智能看到一个文件系统，联合加载会把各层文件系统叠加起来，这样最终的文件系统会包含所有底层的文件和目录</p>
<blockquote>
<p>Docker镜像加载原理</p>
</blockquote>
<p>docker的镜像实际上由一层一层的文件系统组成，这种层级的文件系统UnionFS</p>
<p>bootfs(boot file system)主要包含bootloader和kernel，bootloader主要是引导加载kernel，linux刚启动时会加载bootfs文件系统，在Docker镜像的最底层时bootfs。这一层与我们典型的Linux/Unix系统时一样的，包含boot加载器和内核。当boot加载完成之后整个内核就都在内存中了，此时内存的使用权已由bootfs转交给内核，此时系统也会卸载bootfs</p>
<p>rootfs(root file system)，在bootfs之上，包含的就是典型的Linux系统中的/dev,/proc,/bin,/etc等标准目录和文件。rootfs就是各种不同的操作系统发行版，比如Ubuntu，Centos等等。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tvax2.sinaimg.cn/large/007Z9xVHgy1h6a4yadmmmj30pw07zwj2.jpg"
        data-srcset="https://tvax2.sinaimg.cn/large/007Z9xVHgy1h6a4yadmmmj30pw07zwj2.jpg, https://tvax2.sinaimg.cn/large/007Z9xVHgy1h6a4yadmmmj30pw07zwj2.jpg 1.5x, https://tvax2.sinaimg.cn/large/007Z9xVHgy1h6a4yadmmmj30pw07zwj2.jpg 2x"
        data-sizes="auto"
        alt="https://tvax2.sinaimg.cn/large/007Z9xVHgy1h6a4yadmmmj30pw07zwj2.jpg"
        title="UnionFS" /></p>
<p>平时虚拟机的CentOS有几个G，但是centos镜像只有二百多兆</p>
<p>对于一个精简的OS，rootfs可以很小，只需要包含最基本的命令，工具和程序库就可以，因为底层直接用Host的kernel，自己只需要提供rootfs就可以了。由此可见对于不同的linux发行版，bootfs基本都是一致的，rootfs会有差别，因此不同的发行版可以公用bootfs</p>
<blockquote>
<p>分层的镜像</p>
</blockquote>
<p>下载镜像时，观察下载的日志输出，发现是一层一层的下载</p>
<p><strong>原因</strong>：</p>
<p>资源共享。比如多个镜像都从相同的base镜像构建而来，那么宿主机只需在磁盘上保留一份base镜像，同时内存中也只需要加载一份base镜像，这样就可以为所有的容器服务了，而且镜像的每一层都可以被共享。</p>
<p>查看镜像分层的方式可以通过 docker image inspect 命令</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">$ sdr image inspect 22afbacf753d
...
<span class="s2">&#34;RootFS&#34;</span>: <span class="o">{</span>
            <span class="s2">&#34;Type&#34;</span>: <span class="s2">&#34;layers&#34;</span>,
            <span class="s2">&#34;Layers&#34;</span>: <span class="o">[</span>
                <span class="s2">&#34;sha256:7ac795f5ab480bb362e19552cce3cd9780aba31de91aca50606e381f2b5fdc04&#34;</span>,
                <span class="s2">&#34;sha256:24c3f9ffc7df0db8b16e98211592d96583c39ff5c8ea586350e4bfbb11663bce&#34;</span>,
                <span class="s2">&#34;sha256:ca9d5bcb66762cb171518b1d28b1a2296ba0bd09bc5de8f5eff644a1b8f64043&#34;</span>,
                <span class="s2">&#34;sha256:44dd6b099cde96414b9275866c1a43bbc8e69a29348e0e3501e0e30b4fb73213&#34;</span>,
                <span class="s2">&#34;sha256:b8c503d0b5359439591163e5322340cf600d1eeb9c73214ed6d561b0e4586c58&#34;</span>,
                <span class="s2">&#34;sha256:a4c678688c9ae89a07c707072edf5a8194a5a24e89a298ab0282d587b35aa90a&#34;</span>
            <span class="o">]</span>
        <span class="o">}</span>,
        <span class="s2">&#34;Metadata&#34;</span>: <span class="o">{</span>
            <span class="s2">&#34;LastTagTime&#34;</span>: <span class="s2">&#34;0001-01-01T00:00:00Z&#34;</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">]</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>理解</strong>：</p>
<p>所有的Docker镜像都起始于一个基础镜像层，当进行修改或增加新内容时，就会在当前镜像层之上，创建新的镜像层。</p>
<p>eg. 加入基于 Ubuntu Liux 16.04 创建一个新的镜像，这就是新镜像的第一层；如果在该镜像中添加Python包，就会在基础镜像层之上创建第二个镜像层；如果继续添加一个安全补丁，就会创建第三个镜像层。</p>
<p>该镜像当前已经包含3个镜像层，如下图所示：</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tva2.sinaimg.cn/large/007Z9xVHgy1h6a32ci1itj30nl0evn0i.jpg"
        data-srcset="https://tva2.sinaimg.cn/large/007Z9xVHgy1h6a32ci1itj30nl0evn0i.jpg, https://tva2.sinaimg.cn/large/007Z9xVHgy1h6a32ci1itj30nl0evn0i.jpg 1.5x, https://tva2.sinaimg.cn/large/007Z9xVHgy1h6a32ci1itj30nl0evn0i.jpg 2x"
        data-sizes="auto"
        alt="https://tva2.sinaimg.cn/large/007Z9xVHgy1h6a32ci1itj30nl0evn0i.jpg"
        title="image0" /></p>
<p>在添加额外的镜像层的同时，镜像始终保持时当前所有镜像的组合。下图中每个镜像时包含3个文件，而镜像包含了来自两个镜像层的6个文件</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tvax1.sinaimg.cn/large/007Z9xVHgy1h6a3g1kzrgj30nm0cbq5g.jpg"
        data-srcset="https://tvax1.sinaimg.cn/large/007Z9xVHgy1h6a3g1kzrgj30nm0cbq5g.jpg, https://tvax1.sinaimg.cn/large/007Z9xVHgy1h6a3g1kzrgj30nm0cbq5g.jpg 1.5x, https://tvax1.sinaimg.cn/large/007Z9xVHgy1h6a3g1kzrgj30nm0cbq5g.jpg 2x"
        data-sizes="auto"
        alt="https://tvax1.sinaimg.cn/large/007Z9xVHgy1h6a3g1kzrgj30nm0cbq5g.jpg"
        title="image1" /></p>
<p>上图的镜像层跟之前图中的稍有区别，主要目的是便于展示文件。</p>
<p>下图中展示了一个稍微复杂的三层镜像，在外部看来整个镜像只有6个文件，这是因为最上层中的文件7是文件5的一个更新版本</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tva2.sinaimg.cn/large/007Z9xVHgy1h6a3iugb44j30mu0gbn0q.jpg"
        data-srcset="https://tva2.sinaimg.cn/large/007Z9xVHgy1h6a3iugb44j30mu0gbn0q.jpg, https://tva2.sinaimg.cn/large/007Z9xVHgy1h6a3iugb44j30mu0gbn0q.jpg 1.5x, https://tva2.sinaimg.cn/large/007Z9xVHgy1h6a3iugb44j30mu0gbn0q.jpg 2x"
        data-sizes="auto"
        alt="https://tva2.sinaimg.cn/large/007Z9xVHgy1h6a3iugb44j30mu0gbn0q.jpg"
        title="image2" /></p>
<p>这种情况下，上层镜像层中的文件覆盖了底层镜像层中的文件。这样就使得文件的更新版本作为一个新镜像层添加到镜像当中。</p>
<p>Docker通过存储引擎（新版本采用快照机制）的方式来实现镜像层堆栈，并保证多镜像层对外展示为统一的文件系统。</p>
<p>Linux上可用的存储引擎有AUFS、Overlay2、Device Mapper、Btrfs以及ZFS。顾名思义，每种存储引擎都基于Linux中对应的文件系统或者设备技术，并且每种存储引擎都有其独有的性能特点。</p>
<p>Docker在Windows上仅支持windowsfilter一种存储引擎，该引擎基于NTFS文件系统之上实现了分层和CoW[1]。</p>
<p>下图展示了与系统显示相同的三层镜像。所有镜像层堆叠并合并，对外提供统一的视图。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tva3.sinaimg.cn/large/007Z9xVHgy1h6a3r5kggfj30s408nwgl.jpg"
        data-srcset="https://tva3.sinaimg.cn/large/007Z9xVHgy1h6a3r5kggfj30s408nwgl.jpg, https://tva3.sinaimg.cn/large/007Z9xVHgy1h6a3r5kggfj30s408nwgl.jpg 1.5x, https://tva3.sinaimg.cn/large/007Z9xVHgy1h6a3r5kggfj30s408nwgl.jpg 2x"
        data-sizes="auto"
        alt="https://tva3.sinaimg.cn/large/007Z9xVHgy1h6a3r5kggfj30s408nwgl.jpg"
        title="image3" /></p>
<blockquote>
<p>特点</p>
</blockquote>
<p>Docker镜像都是只读的，当容器启动时，一个新的可写层被加载到镜像的顶部
这一层就是通常说的容器层，容器之下的都叫镜像层</p>
<h2 id="commit镜像">commit镜像</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="c1"># 和git差不多</span>
docker commit -m<span class="o">=</span><span class="s2">&#34;提交的描述信息&#34;</span> -a<span class="o">=</span><span class="s2">&#34;作者&#34;</span> 容器id 目标镜像名:TAG 
</code></pre></td></tr></table>
</div>
</div><h1 id="容器数据卷">容器数据卷</h1>
<h2 id="什么是容器数据卷">什么是容器数据卷</h2>
<p>docker理念：将应用和环境打包成一个镜像</p>
<p>but：如果数据都在容器中，那么容器一删除，数据就会丢失。</p>
<p>–-&gt;需求：数据可以持久化</p>
<p>容器之间可以有一个数据共享技术：Docker容器中产生的数据同步到本地</p>
<p>即卷技术，目录的挂载，将容器内的目录挂载到Linux上</p>
<p><strong>容器的持久化和同步操作，同时容器间也可以数据共享</strong></p>
<h2 id="使用数据卷">使用数据卷</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="c1"># docker run -it -v 主机目录:容器内目录</span>

sdr run -it -v /home/ubuntu/test:/home centos /bin/bash

</code></pre></td></tr></table>
</div>
</div><p>无论容器是否开启，无论正向操作还是反向操作，指定通道文件均正常共享</p>
<p>优点：本地修改，容器自动同步</p>
<h2 id="安装mysql">安装MySQL</h2>
<p>详情查看dockerhub解释，其中<code>-e</code>是环境配置，配置root密码之类的</p>
<h2 id="具名和匿名挂载">具名和匿名挂载</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="c1"># 匿名挂载</span>
-v 容器内路径 <span class="c1"># 自动生成主机目录</span>
$ sdr run -d -P --name nginx-test -v /etc/nginx nginx
<span class="c1"># -P是随机映射端口</span>

<span class="c1"># 卷相关操作</span>
sdr volume <span class="o">[</span>参数<span class="o">]</span>
$ sdr volume ls
DRIVER    VOLUME NAME
<span class="nb">local</span>     e971a7e87e336058a1b2466da64c75d2938c5c6b3b70f07ccc8ea6fbfd005673
<span class="c1"># 匿名卷挂载</span>

<span class="c1"># 具名挂载</span>
<span class="c1"># -v 卷名:容器内路径</span>
$ sdr run -d -P --name nginx02 -v juming-nginx:/etc/nginx nginx
$ sdr volume ls
DRIVER    VOLUME NAME
<span class="nb">local</span>     e971a7e87e336058a1b2466da64c75d2938c5c6b3b70f07ccc8ea6fbfd005673
<span class="nb">local</span>     juming-nginx
</code></pre></td></tr></table>
</div>
</div><p>查看具体位置</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">$ sdr volume inspect juming-nginx
<span class="o">[</span>
    <span class="o">{</span>
        <span class="s2">&#34;CreatedAt&#34;</span>: <span class="s2">&#34;2022-09-20T01:09:40+08:00&#34;</span>,
        <span class="s2">&#34;Driver&#34;</span>: <span class="s2">&#34;local&#34;</span>,
        <span class="s2">&#34;Labels&#34;</span>: null,
        <span class="s2">&#34;Mountpoint&#34;</span>: <span class="s2">&#34;/var/lib/docker/volumes/juming-nginx/_data&#34;</span>,
        <span class="s2">&#34;Name&#34;</span>: <span class="s2">&#34;juming-nginx&#34;</span>,
        <span class="s2">&#34;Options&#34;</span>: null,
        <span class="s2">&#34;Scope&#34;</span>: <span class="s2">&#34;local&#34;</span>
    <span class="o">}</span>
<span class="o">]</span>
<span class="c1"># mountpoint就是具体挂载地址</span>
</code></pre></td></tr></table>
</div>
</div><p>所有docker容器内的卷，在没有指定目录的情况下都是在<code>/var/lib/docker/volumes/xxxx/_data</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="nb">cd</span> /var/lib/docker/volumes
root@VM-4-3-ubuntu:/var/lib/docker/volumes# ls
backingFsBlockDev                                                 juming-nginx
e971a7e87e336058a1b2466da64c75d2938c5c6b3b70f07ccc8ea6fbfd005673  metadata.db
</code></pre></td></tr></table>
</div>
</div><p>一般都是具名挂载，方便找到卷，或者自定主机路径</p>
<p><strong>拓展：</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="c1"># 有时会在容器后再加参数ro rw</span>
ro：readonly
rw：readwrite

<span class="c1"># 参数是对容器生效，ro指该文件只能从外部改变</span>
sdr run -d -P --name nginx02 -v juming-nginx:/etc/nginx:ro nginx
sdr run -d -P --name nginx02 -v juming-nginx:/etc/nginx:rw nginx

</code></pre></td></tr></table>
</div>
</div><h2 id="dockerfile初识">Dockerfile初识</h2>
<p>Dockerfile是用来构建docker镜像的构建文件，是命令脚本</p>
<p>通过这个脚本可以生成镜像，镜像一层一层的，脚本一个一个的命令，每个命令都是一层</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">$ mkdir docker-test-volume
$ <span class="nb">cd</span> docker-test-volume
$ vim dockerfile1
<span class="c1"># 这里的每个命令,就是镜像的一层</span>
FROM centos
<span class="c1"># 挂载数据卷目录</span>
<span class="c1"># 通过docker inspect中的mounts查看挂载的目录</span>
VOLUME <span class="o">[</span><span class="s2">&#34;/volume01&#34;</span>,<span class="s2">&#34;/volume02&#34;</span><span class="o">]</span>

CMD <span class="nb">echo</span> <span class="s2">&#34;---end---&#34;</span>

CMD /bin/bash

$ docker build -f dockerfile1 -t qinm/centos:latest .
<span class="c1"># -f 设置地址</span>
<span class="c1"># -t tag,设置标签</span>
Sending build context to Docker daemon  2.048kB
Step 1/4 : FROM centos
 ---&gt; 5d0da3dc9764
Step 2/4 : VOLUME <span class="o">[</span><span class="s2">&#34;volume01&#34;</span>,<span class="s2">&#34;volume02&#34;</span><span class="o">]</span>
 ---&gt; Running in 502845653bb0
Removing intermediate container 502845653bb0
 ---&gt; cc7399fde6c6
Step 3/4 : CMD <span class="nb">echo</span> <span class="s2">&#34;---end---&#34;</span>
 ---&gt; Running in 1c6e2ad7f22b
Removing intermediate container 1c6e2ad7f22b
 ---&gt; 02c44d547986
Step 4/4 : CMD /bin/bash
 ---&gt; Running in 9fa10a85fe26
Removing intermediate container 9fa10a85fe26
 ---&gt; 3f4f6e063605
Successfully built 3f4f6e063605
Successfully tagged qinm/centos:latest
</code></pre></td></tr></table>
</div>
</div><h2 id="数据卷容器">数据卷容器</h2>
<p>docker run 时,通过添加参数<code>\--volumes-from docker名</code>挂载其他容器的数据卷</p>
<p>似乎可以通过 -v 指定要挂载的容器</p>
<h1 id="dockerfile">Dockerfile</h1>
<p>dockerfile 是用来构建docker镜像的文件,就是一个命令参数脚本</p>
<p>官方镜像都是一些基础镜像,我们需要构建自己的镜像</p>
<h2 id="dockerfile构建过程">DockerFile构建过程</h2>
<p><strong>基础知识:</strong></p>
<ol>
<li>每个保留关键字(指令)都最好是大写字母</li>
<li>执行从上到下顺序执行</li>
<li># 表示注释</li>
<li>每一个指令都会创建提交一个新的镜像层,并提交</li>
</ol>
<p>dockerfile –&gt;dockerimages –&gt;docker容器</p>
<h2 id="dockerfile指令">dockerfile指令</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">FROM			<span class="c1"># 指定基础镜像</span>
MAINTAINER		<span class="c1"># 镜像是谁写的, 姓名+邮箱</span>
RUN				<span class="c1"># 镜像构建的时候需要运行的命令</span>
ADD				<span class="c1"># 步骤,添加其他东西(比如tomcat镜像之类的)</span>
WORKDIR			<span class="c1"># 镜像的工作目录</span>
VOLUME			<span class="c1"># 挂载的目录</span>
EXPOSE			<span class="c1"># 指定暴露的端口</span>
CMD				<span class="c1"># 指定这个容器要启动时候要运行的命令,只有最后一个会生效,可被替代</span>
ENTRYPOINT		<span class="c1"># 指定这个容器要启动时候要运行的命令,可以追加命令</span>
ONBUILD			<span class="c1"># 当构建一个被继承 Dockerfile 这个时候会运行该指令,是一个触发指令</span>
COPY			<span class="c1"># 类似add,将我们的文件拷贝到镜像中</span>
ENV				<span class="c1"># 构建的时候设置环境变量</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>CMD和ENTRYPOINT区别:</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-SHELL" data-lang="SHELL">CMD ls -a
docker run -l时会将-l替换ls -a

ENTRYPOINT ls -a
docker run -l时会将-l追加到之后,变为ls -a -l
</code></pre></td></tr></table>
</div>
</div><h2 id="实操">实操</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="c1"># 编写dockerfile</span>
$ vim mydockerfile-centos
FROM centos:7 <span class="c1"># 需要指定centos:7不然yum会报错</span>
MAINTAINER wnqinm&lt;flidwala@gmail.com&gt;

ENV MYPATH /usr/local
WORKDIR <span class="nv">$MYPATH</span>

RUN yum -y install vim
RUN yum -y install net-tools

EXPOSE <span class="m">80</span>

CMD /bin/bash
$ sdr build -f mydockerfile-centos -t mycentos:latest .
</code></pre></td></tr></table>
</div>
</div><p>之后会输出以下信息:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span><span class="lnt">194
</span><span class="lnt">195
</span><span class="lnt">196
</span><span class="lnt">197
</span><span class="lnt">198
</span><span class="lnt">199
</span><span class="lnt">200
</span><span class="lnt">201
</span><span class="lnt">202
</span><span class="lnt">203
</span><span class="lnt">204
</span><span class="lnt">205
</span><span class="lnt">206
</span><span class="lnt">207
</span><span class="lnt">208
</span><span class="lnt">209
</span><span class="lnt">210
</span><span class="lnt">211
</span><span class="lnt">212
</span><span class="lnt">213
</span><span class="lnt">214
</span><span class="lnt">215
</span><span class="lnt">216
</span><span class="lnt">217
</span><span class="lnt">218
</span><span class="lnt">219
</span><span class="lnt">220
</span><span class="lnt">221
</span><span class="lnt">222
</span><span class="lnt">223
</span><span class="lnt">224
</span><span class="lnt">225
</span><span class="lnt">226
</span><span class="lnt">227
</span><span class="lnt">228
</span><span class="lnt">229
</span><span class="lnt">230
</span><span class="lnt">231
</span><span class="lnt">232
</span><span class="lnt">233
</span><span class="lnt">234
</span><span class="lnt">235
</span><span class="lnt">236
</span><span class="lnt">237
</span><span class="lnt">238
</span><span class="lnt">239
</span><span class="lnt">240
</span><span class="lnt">241
</span><span class="lnt">242
</span><span class="lnt">243
</span><span class="lnt">244
</span><span class="lnt">245
</span><span class="lnt">246
</span><span class="lnt">247
</span><span class="lnt">248
</span><span class="lnt">249
</span><span class="lnt">250
</span><span class="lnt">251
</span><span class="lnt">252
</span><span class="lnt">253
</span><span class="lnt">254
</span><span class="lnt">255
</span><span class="lnt">256
</span><span class="lnt">257
</span><span class="lnt">258
</span><span class="lnt">259
</span><span class="lnt">260
</span><span class="lnt">261
</span><span class="lnt">262
</span><span class="lnt">263
</span><span class="lnt">264
</span><span class="lnt">265
</span><span class="lnt">266
</span><span class="lnt">267
</span><span class="lnt">268
</span><span class="lnt">269
</span><span class="lnt">270
</span><span class="lnt">271
</span><span class="lnt">272
</span><span class="lnt">273
</span><span class="lnt">274
</span><span class="lnt">275
</span><span class="lnt">276
</span><span class="lnt">277
</span><span class="lnt">278
</span><span class="lnt">279
</span><span class="lnt">280
</span><span class="lnt">281
</span><span class="lnt">282
</span><span class="lnt">283
</span><span class="lnt">284
</span><span class="lnt">285
</span><span class="lnt">286
</span><span class="lnt">287
</span><span class="lnt">288
</span><span class="lnt">289
</span><span class="lnt">290
</span><span class="lnt">291
</span><span class="lnt">292
</span><span class="lnt">293
</span><span class="lnt">294
</span><span class="lnt">295
</span><span class="lnt">296
</span><span class="lnt">297
</span><span class="lnt">298
</span><span class="lnt">299
</span><span class="lnt">300
</span><span class="lnt">301
</span><span class="lnt">302
</span><span class="lnt">303
</span><span class="lnt">304
</span><span class="lnt">305
</span><span class="lnt">306
</span><span class="lnt">307
</span><span class="lnt">308
</span><span class="lnt">309
</span><span class="lnt">310
</span><span class="lnt">311
</span><span class="lnt">312
</span><span class="lnt">313
</span><span class="lnt">314
</span><span class="lnt">315
</span><span class="lnt">316
</span><span class="lnt">317
</span><span class="lnt">318
</span><span class="lnt">319
</span><span class="lnt">320
</span><span class="lnt">321
</span><span class="lnt">322
</span><span class="lnt">323
</span><span class="lnt">324
</span><span class="lnt">325
</span><span class="lnt">326
</span><span class="lnt">327
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">Sending build context to Docker daemon  2.048kB
Step 1/8 : FROM centos:7
7: Pulling from library/centos
2d473b07cdd5: Pull <span class="nb">complete</span>
Digest: sha256:c73f515d06b0fa07bb18d8202035e739a494ce760aa73129f60f4bf2bd22b407
Status: Downloaded newer image <span class="k">for</span> centos:7
 ---&gt; eeb6ee3f44bd
Step 2/8 : MAINTAINER wnqinm&lt;flidwala@gmail.com&gt;
 ---&gt; Running in 3f3163ef6fc6
Removing intermediate container 3f3163ef6fc6
 ---&gt; 7cc6b3b953d1
Step 3/8 : ENV MYPATH /usr/local
 ---&gt; Running in 91d3be697355
Removing intermediate container 91d3be697355
 ---&gt; 3c456a5a6c70
Step 4/8 : WORKDIR <span class="nv">$MYPATH</span>
 ---&gt; Running in 34d1a3844471
Removing intermediate container 34d1a3844471
 ---&gt; 0aed096774e0
Step 5/8 : RUN yum -y install vim
 ---&gt; Running in 8ff92ad9ec1e
Loaded plugins: fastestmirror, ovl
Determining fastest mirrors
 * base: mirrors.nju.edu.cn
 * extras: ftp.sjtu.edu.cn
 * updates: ftp.sjtu.edu.cn
Resolving Dependencies
--&gt; Running transaction check
---&gt; Package vim-enhanced.x86_64 2:7.4.629-8.el7_9 will be installed
--&gt; Processing Dependency: vim-common <span class="o">=</span> 2:7.4.629-8.el7_9 <span class="k">for</span> package: 2:vim-enhanced-7.4.629-8.el7_9.x86_64
--&gt; Processing Dependency: which <span class="k">for</span> package: 2:vim-enhanced-7.4.629-8.el7_9.x86_64
--&gt; Processing Dependency: perl<span class="o">(</span>:MODULE_COMPAT_5.16.3<span class="o">)</span> <span class="k">for</span> package: 2:vim-enhanced-7.4.629-8.el7_9.x86_64
--&gt; Processing Dependency: libperl.so<span class="o">()(</span>64bit<span class="o">)</span> <span class="k">for</span> package: 2:vim-enhanced-7.4.629-8.el7_9.x86_64
--&gt; Processing Dependency: libgpm.so.2<span class="o">()(</span>64bit<span class="o">)</span> <span class="k">for</span> package: 2:vim-enhanced-7.4.629-8.el7_9.x86_64
--&gt; Running transaction check
---&gt; Package gpm-libs.x86_64 0:1.20.7-6.el7 will be installed
---&gt; Package perl.x86_64 4:5.16.3-299.el7_9 will be installed
--&gt; Processing Dependency: perl<span class="o">(</span>Socket<span class="o">)</span> &gt;<span class="o">=</span> 1.3 <span class="k">for</span> package: 4:perl-5.16.3-299.el7_9.x86_64
--&gt; Processing Dependency: perl<span class="o">(</span>Scalar::Util<span class="o">)</span> &gt;<span class="o">=</span> 1.10 <span class="k">for</span> package: 4:perl-5.16.3-299.el7_9.x86_64
--&gt; Processing Dependency: perl-macros <span class="k">for</span> package: 4:perl-5.16.3-299.el7_9.x86_64
--&gt; Processing Dependency: perl<span class="o">(</span>threads::shared<span class="o">)</span> <span class="k">for</span> package: 4:perl-5.16.3-299.el7_9.x86_64
--&gt; Processing Dependency: perl<span class="o">(</span>threads<span class="o">)</span> <span class="k">for</span> package: 4:perl-5.16.3-299.el7_9.x86_64
--&gt; Processing Dependency: perl<span class="o">(</span>constant<span class="o">)</span> <span class="k">for</span> package: 4:perl-5.16.3-299.el7_9.x86_64
--&gt; Processing Dependency: perl<span class="o">(</span>Time::Local<span class="o">)</span> <span class="k">for</span> package: 4:perl-5.16.3-299.el7_9.x86_64
--&gt; Processing Dependency: perl<span class="o">(</span>Time::HiRes<span class="o">)</span> <span class="k">for</span> package: 4:perl-5.16.3-299.el7_9.x86_64
--&gt; Processing Dependency: perl<span class="o">(</span>Storable<span class="o">)</span> <span class="k">for</span> package: 4:perl-5.16.3-299.el7_9.x86_64
--&gt; Processing Dependency: perl<span class="o">(</span>Socket<span class="o">)</span> <span class="k">for</span> package: 4:perl-5.16.3-299.el7_9.x86_64
--&gt; Processing Dependency: perl<span class="o">(</span>Scalar::Util<span class="o">)</span> <span class="k">for</span> package: 4:perl-5.16.3-299.el7_9.x86_64
--&gt; Processing Dependency: perl<span class="o">(</span>Pod::Simple::XHTML<span class="o">)</span> <span class="k">for</span> package: 4:perl-5.16.3-299.el7_9.x86_64
--&gt; Processing Dependency: perl<span class="o">(</span>Pod::Simple::Search<span class="o">)</span> <span class="k">for</span> package: 4:perl-5.16.3-299.el7_9.x86_64
--&gt; Processing Dependency: perl<span class="o">(</span>Getopt::Long<span class="o">)</span> <span class="k">for</span> package: 4:perl-5.16.3-299.el7_9.x86_64
--&gt; Processing Dependency: perl<span class="o">(</span>Filter::Util::Call<span class="o">)</span> <span class="k">for</span> package: 4:perl-5.16.3-299.el7_9.x86_64
--&gt; Processing Dependency: perl<span class="o">(</span>File::Temp<span class="o">)</span> <span class="k">for</span> package: 4:perl-5.16.3-299.el7_9.x86_64
--&gt; Processing Dependency: perl<span class="o">(</span>File::Spec::Unix<span class="o">)</span> <span class="k">for</span> package: 4:perl-5.16.3-299.el7_9.x86_64
--&gt; Processing Dependency: perl<span class="o">(</span>File::Spec::Functions<span class="o">)</span> <span class="k">for</span> package: 4:perl-5.16.3-299.el7_9.x86_64
--&gt; Processing Dependency: perl<span class="o">(</span>File::Spec<span class="o">)</span> <span class="k">for</span> package: 4:perl-5.16.3-299.el7_9.x86_64
--&gt; Processing Dependency: perl<span class="o">(</span>File::Path<span class="o">)</span> <span class="k">for</span> package: 4:perl-5.16.3-299.el7_9.x86_64
--&gt; Processing Dependency: perl<span class="o">(</span>Exporter<span class="o">)</span> <span class="k">for</span> package: 4:perl-5.16.3-299.el7_9.x86_64
--&gt; Processing Dependency: perl<span class="o">(</span>Cwd<span class="o">)</span> <span class="k">for</span> package: 4:perl-5.16.3-299.el7_9.x86_64
--&gt; Processing Dependency: perl<span class="o">(</span>Carp<span class="o">)</span> <span class="k">for</span> package: 4:perl-5.16.3-299.el7_9.x86_64
---&gt; Package perl-libs.x86_64 4:5.16.3-299.el7_9 will be installed
---&gt; Package vim-common.x86_64 2:7.4.629-8.el7_9 will be installed
--&gt; Processing Dependency: vim-filesystem <span class="k">for</span> package: 2:vim-common-7.4.629-8.el7_9.x86_64
---&gt; Package which.x86_64 0:2.20-7.el7 will be installed
--&gt; Running transaction check
---&gt; Package perl-Carp.noarch 0:1.26-244.el7 will be installed
---&gt; Package perl-Exporter.noarch 0:5.68-3.el7 will be installed
---&gt; Package perl-File-Path.noarch 0:2.09-2.el7 will be installed
---&gt; Package perl-File-Temp.noarch 0:0.23.01-3.el7 will be installed
---&gt; Package perl-Filter.x86_64 0:1.49-3.el7 will be installed
---&gt; Package perl-Getopt-Long.noarch 0:2.40-3.el7 will be installed
--&gt; Processing Dependency: perl<span class="o">(</span>Pod::Usage<span class="o">)</span> &gt;<span class="o">=</span> 1.14 <span class="k">for</span> package: perl-Getopt-Long-2.40-3.el7.noarch
--&gt; Processing Dependency: perl<span class="o">(</span>Text::ParseWords<span class="o">)</span> <span class="k">for</span> package: perl-Getopt-Long-2.40-3.el7.noarch
---&gt; Package perl-PathTools.x86_64 0:3.40-5.el7 will be installed
---&gt; Package perl-Pod-Simple.noarch 1:3.28-4.el7 will be installed
--&gt; Processing Dependency: perl<span class="o">(</span>Pod::Escapes<span class="o">)</span> &gt;<span class="o">=</span> 1.04 <span class="k">for</span> package: 1:perl-Pod-Simple-3.28-4.el7.noarch
--&gt; Processing Dependency: perl<span class="o">(</span>Encode<span class="o">)</span> <span class="k">for</span> package: 1:perl-Pod-Simple-3.28-4.el7.noarch
---&gt; Package perl-Scalar-List-Utils.x86_64 0:1.27-248.el7 will be installed
---&gt; Package perl-Socket.x86_64 0:2.010-5.el7 will be installed
---&gt; Package perl-Storable.x86_64 0:2.45-3.el7 will be installed
---&gt; Package perl-Time-HiRes.x86_64 4:1.9725-3.el7 will be installed
---&gt; Package perl-Time-Local.noarch 0:1.2300-2.el7 will be installed
---&gt; Package perl-constant.noarch 0:1.27-2.el7 will be installed
---&gt; Package perl-macros.x86_64 4:5.16.3-299.el7_9 will be installed
---&gt; Package perl-threads.x86_64 0:1.87-4.el7 will be installed
---&gt; Package perl-threads-shared.x86_64 0:1.43-6.el7 will be installed
---&gt; Package vim-filesystem.x86_64 2:7.4.629-8.el7_9 will be installed
--&gt; Running transaction check
---&gt; Package perl-Encode.x86_64 0:2.51-7.el7 will be installed
---&gt; Package perl-Pod-Escapes.noarch 1:1.04-299.el7_9 will be installed
---&gt; Package perl-Pod-Usage.noarch 0:1.63-3.el7 will be installed
--&gt; Processing Dependency: perl<span class="o">(</span>Pod::Text<span class="o">)</span> &gt;<span class="o">=</span> 3.15 <span class="k">for</span> package: perl-Pod-Usage-1.63-3.el7.noarch
--&gt; Processing Dependency: perl-Pod-Perldoc <span class="k">for</span> package: perl-Pod-Usage-1.63-3.el7.noarch
---&gt; Package perl-Text-ParseWords.noarch 0:3.29-4.el7 will be installed
--&gt; Running transaction check
---&gt; Package perl-Pod-Perldoc.noarch 0:3.20-4.el7 will be installed
--&gt; Processing Dependency: perl<span class="o">(</span>parent<span class="o">)</span> <span class="k">for</span> package: perl-Pod-Perldoc-3.20-4.el7.noarch
--&gt; Processing Dependency: perl<span class="o">(</span>HTTP::Tiny<span class="o">)</span> <span class="k">for</span> package: perl-Pod-Perldoc-3.20-4.el7.noarch
--&gt; Processing Dependency: groff-base <span class="k">for</span> package: perl-Pod-Perldoc-3.20-4.el7.noarch
---&gt; Package perl-podlators.noarch 0:2.5.1-3.el7 will be installed
--&gt; Running transaction check
---&gt; Package groff-base.x86_64 0:1.22.2-8.el7 will be installed
---&gt; Package perl-HTTP-Tiny.noarch 0:0.033-3.el7 will be installed
---&gt; Package perl-parent.noarch 1:0.225-244.el7 will be installed
--&gt; Finished Dependency Resolution

Dependencies <span class="nv">Resolved</span>

<span class="o">================================================================================</span>
 Package                    Arch       Version                Repository   <span class="nv">Size</span>
<span class="o">================================================================================</span>
Installing:
 vim-enhanced               x86_64     2:7.4.629-8.el7_9      updates     1.1 M
Installing <span class="k">for</span> dependencies:
 gpm-libs                   x86_64     1.20.7-6.el7           base         <span class="m">32</span> k
 groff-base                 x86_64     1.22.2-8.el7           base        <span class="m">942</span> k
 perl                       x86_64     4:5.16.3-299.el7_9     updates     8.0 M
 perl-Carp                  noarch     1.26-244.el7           base         <span class="m">19</span> k
 perl-Encode                x86_64     2.51-7.el7             base        1.5 M
 perl-Exporter              noarch     5.68-3.el7             base         <span class="m">28</span> k
 perl-File-Path             noarch     2.09-2.el7             base         <span class="m">26</span> k
 perl-File-Temp             noarch     0.23.01-3.el7          base         <span class="m">56</span> k
 perl-Filter                x86_64     1.49-3.el7             base         <span class="m">76</span> k
 perl-Getopt-Long           noarch     2.40-3.el7             base         <span class="m">56</span> k
 perl-HTTP-Tiny             noarch     0.033-3.el7            base         <span class="m">38</span> k
 perl-PathTools             x86_64     3.40-5.el7             base         <span class="m">82</span> k
 perl-Pod-Escapes           noarch     1:1.04-299.el7_9       updates      <span class="m">52</span> k
 perl-Pod-Perldoc           noarch     3.20-4.el7             base         <span class="m">87</span> k
 perl-Pod-Simple            noarch     1:3.28-4.el7           base        <span class="m">216</span> k
 perl-Pod-Usage             noarch     1.63-3.el7             base         <span class="m">27</span> k
 perl-Scalar-List-Utils     x86_64     1.27-248.el7           base         <span class="m">36</span> k
 perl-Socket                x86_64     2.010-5.el7            base         <span class="m">49</span> k
 perl-Storable              x86_64     2.45-3.el7             base         <span class="m">77</span> k
 perl-Text-ParseWords       noarch     3.29-4.el7             base         <span class="m">14</span> k
 perl-Time-HiRes            x86_64     4:1.9725-3.el7         base         <span class="m">45</span> k
 perl-Time-Local            noarch     1.2300-2.el7           base         <span class="m">24</span> k
 perl-constant              noarch     1.27-2.el7             base         <span class="m">19</span> k
 perl-libs                  x86_64     4:5.16.3-299.el7_9     updates     <span class="m">690</span> k
 perl-macros                x86_64     4:5.16.3-299.el7_9     updates      <span class="m">44</span> k
 perl-parent                noarch     1:0.225-244.el7        base         <span class="m">12</span> k
 perl-podlators             noarch     2.5.1-3.el7            base        <span class="m">112</span> k
 perl-threads               x86_64     1.87-4.el7             base         <span class="m">49</span> k
 perl-threads-shared        x86_64     1.43-6.el7             base         <span class="m">39</span> k
 vim-common                 x86_64     2:7.4.629-8.el7_9      updates     5.9 M
 vim-filesystem             x86_64     2:7.4.629-8.el7_9      updates      <span class="m">11</span> k
 which                      x86_64     2.20-7.el7             base         <span class="m">41</span> k

Transaction <span class="nv">Summary</span>
<span class="o">================================================================================</span>
Install  <span class="m">1</span> Package <span class="o">(</span>+32 Dependent packages<span class="o">)</span>

Total download size: <span class="m">19</span> M
Installed size: <span class="m">63</span> M
Downloading packages:
warning: /var/cache/yum/x86_64/7/base/packages/gpm-libs-1.20.7-6.el7.x86_64.rpm: Header V3 RSA/SHA256 Signature, key ID f4a80eb5: NOKEY
Public key <span class="k">for</span> gpm-libs-1.20.7-6.el7.x86_64.rpm is not installed
Public key <span class="k">for</span> perl-Pod-Escapes-1.04-299.el7_9.noarch.rpm is not installed
--------------------------------------------------------------------------------
Total                                              1.3 MB/s <span class="p">|</span>  <span class="m">19</span> MB  00:15
Retrieving key from file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-7
Importing GPG key 0xF4A80EB5:
 Userid     : <span class="s2">&#34;CentOS-7 Key (CentOS 7 Official Signing Key) &lt;security@centos.org&gt;&#34;</span>
 Fingerprint: <span class="m">6341</span> ab27 53d7 8a78 a7c2 7bb1 24c6 a8a7 f4a8 0eb5
 Package    : centos-release-7-9.2009.0.el7.centos.x86_64 <span class="o">(</span>@CentOS<span class="o">)</span>
 From       : /etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-7
Running transaction check
Running transaction <span class="nb">test</span>
Transaction <span class="nb">test</span> succeeded
Running transaction
  Installing : gpm-libs-1.20.7-6.el7.x86_64                                1/33
  Installing : 2:vim-filesystem-7.4.629-8.el7_9.x86_64                     2/33
  Installing : 2:vim-common-7.4.629-8.el7_9.x86_64                         3/33
  Installing : which-2.20-7.el7.x86_64                                     4/33
install-info: No such file or directory <span class="k">for</span> /usr/share/info/which.info.gz
  Installing : groff-base-1.22.2-8.el7.x86_64                              5/33
  Installing : 1:perl-parent-0.225-244.el7.noarch                          6/33
  Installing : perl-HTTP-Tiny-0.033-3.el7.noarch                           7/33
  Installing : perl-podlators-2.5.1-3.el7.noarch                           8/33
  Installing : perl-Pod-Perldoc-3.20-4.el7.noarch                          9/33
  Installing : 1:perl-Pod-Escapes-1.04-299.el7_9.noarch                   10/33
  Installing : perl-Encode-2.51-7.el7.x86_64                              11/33
  Installing : perl-Text-ParseWords-3.29-4.el7.noarch                     12/33
  Installing : perl-Pod-Usage-1.63-3.el7.noarch                           13/33
  Installing : 4:perl-macros-5.16.3-299.el7_9.x86_64                      14/33
  Installing : perl-Storable-2.45-3.el7.x86_64                            15/33
  Installing : perl-Exporter-5.68-3.el7.noarch                            16/33
  Installing : perl-constant-1.27-2.el7.noarch                            17/33
  Installing : perl-Socket-2.010-5.el7.x86_64                             18/33
  Installing : perl-Time-Local-1.2300-2.el7.noarch                        19/33
  Installing : perl-Carp-1.26-244.el7.noarch                              20/33
  Installing : perl-PathTools-3.40-5.el7.x86_64                           21/33
  Installing : perl-Scalar-List-Utils-1.27-248.el7.x86_64                 22/33
  Installing : 1:perl-Pod-Simple-3.28-4.el7.noarch                        23/33
  Installing : perl-File-Temp-0.23.01-3.el7.noarch                        24/33
  Installing : perl-File-Path-2.09-2.el7.noarch                           25/33
  Installing : perl-threads-shared-1.43-6.el7.x86_64                      26/33
  Installing : perl-threads-1.87-4.el7.x86_64                             27/33
  Installing : 4:perl-Time-HiRes-1.9725-3.el7.x86_64                      28/33
  Installing : perl-Filter-1.49-3.el7.x86_64                              29/33
  Installing : 4:perl-libs-5.16.3-299.el7_9.x86_64                        30/33
  Installing : perl-Getopt-Long-2.40-3.el7.noarch                         31/33
  Installing : 4:perl-5.16.3-299.el7_9.x86_64                             32/33
  Installing : 2:vim-enhanced-7.4.629-8.el7_9.x86_64                      33/33
  Verifying  : perl-HTTP-Tiny-0.033-3.el7.noarch                           1/33
  Verifying  : perl-threads-shared-1.43-6.el7.x86_64                       2/33
  Verifying  : perl-Storable-2.45-3.el7.x86_64                             3/33
  Verifying  : groff-base-1.22.2-8.el7.x86_64                              4/33
  Verifying  : perl-Exporter-5.68-3.el7.noarch                             5/33
  Verifying  : perl-constant-1.27-2.el7.noarch                             6/33
  Verifying  : perl-PathTools-3.40-5.el7.x86_64                            7/33
  Verifying  : 4:perl-macros-5.16.3-299.el7_9.x86_64                       8/33
  Verifying  : 2:vim-enhanced-7.4.629-8.el7_9.x86_64                       9/33
  Verifying  : 1:perl-parent-0.225-244.el7.noarch                         10/33
  Verifying  : perl-Socket-2.010-5.el7.x86_64                             11/33
  Verifying  : which-2.20-7.el7.x86_64                                    12/33
  Verifying  : 2:vim-filesystem-7.4.629-8.el7_9.x86_64                    13/33
  Verifying  : perl-File-Temp-0.23.01-3.el7.noarch                        14/33
  Verifying  : 1:perl-Pod-Simple-3.28-4.el7.noarch                        15/33
  Verifying  : perl-Time-Local-1.2300-2.el7.noarch                        16/33
  Verifying  : 1:perl-Pod-Escapes-1.04-299.el7_9.noarch                   17/33
  Verifying  : perl-Carp-1.26-244.el7.noarch                              18/33
  Verifying  : 2:vim-common-7.4.629-8.el7_9.x86_64                        19/33
  Verifying  : perl-Scalar-List-Utils-1.27-248.el7.x86_64                 20/33
  Verifying  : perl-Pod-Usage-1.63-3.el7.noarch                           21/33
  Verifying  : perl-Encode-2.51-7.el7.x86_64                              22/33
  Verifying  : perl-Pod-Perldoc-3.20-4.el7.noarch                         23/33
  Verifying  : perl-podlators-2.5.1-3.el7.noarch                          24/33
  Verifying  : 4:perl-5.16.3-299.el7_9.x86_64                             25/33
  Verifying  : perl-File-Path-2.09-2.el7.noarch                           26/33
  Verifying  : perl-threads-1.87-4.el7.x86_64                             27/33
  Verifying  : 4:perl-Time-HiRes-1.9725-3.el7.x86_64                      28/33
  Verifying  : gpm-libs-1.20.7-6.el7.x86_64                               29/33
  Verifying  : perl-Filter-1.49-3.el7.x86_64                              30/33
  Verifying  : perl-Getopt-Long-2.40-3.el7.noarch                         31/33
  Verifying  : perl-Text-ParseWords-3.29-4.el7.noarch                     32/33
  Verifying  : 4:perl-libs-5.16.3-299.el7_9.x86_64                        33/33

Installed:
  vim-enhanced.x86_64 2:7.4.629-8.el7_9

Dependency Installed:
  gpm-libs.x86_64 0:1.20.7-6.el7
  groff-base.x86_64 0:1.22.2-8.el7
  perl.x86_64 4:5.16.3-299.el7_9
  perl-Carp.noarch 0:1.26-244.el7
  perl-Encode.x86_64 0:2.51-7.el7
  perl-Exporter.noarch 0:5.68-3.el7
  perl-File-Path.noarch 0:2.09-2.el7
  perl-File-Temp.noarch 0:0.23.01-3.el7
  perl-Filter.x86_64 0:1.49-3.el7
  perl-Getopt-Long.noarch 0:2.40-3.el7
  perl-HTTP-Tiny.noarch 0:0.033-3.el7
  perl-PathTools.x86_64 0:3.40-5.el7
  perl-Pod-Escapes.noarch 1:1.04-299.el7_9
  perl-Pod-Perldoc.noarch 0:3.20-4.el7
  perl-Pod-Simple.noarch 1:3.28-4.el7
  perl-Pod-Usage.noarch 0:1.63-3.el7
  perl-Scalar-List-Utils.x86_64 0:1.27-248.el7
  perl-Socket.x86_64 0:2.010-5.el7
  perl-Storable.x86_64 0:2.45-3.el7
  perl-Text-ParseWords.noarch 0:3.29-4.el7
  perl-Time-HiRes.x86_64 4:1.9725-3.el7
  perl-Time-Local.noarch 0:1.2300-2.el7
  perl-constant.noarch 0:1.27-2.el7
  perl-libs.x86_64 4:5.16.3-299.el7_9
  perl-macros.x86_64 4:5.16.3-299.el7_9
  perl-parent.noarch 1:0.225-244.el7
  perl-podlators.noarch 0:2.5.1-3.el7
  perl-threads.x86_64 0:1.87-4.el7
  perl-threads-shared.x86_64 0:1.43-6.el7
  vim-common.x86_64 2:7.4.629-8.el7_9
  vim-filesystem.x86_64 2:7.4.629-8.el7_9
  which.x86_64 0:2.20-7.el7

Complete!
Removing intermediate container 8ff92ad9ec1e
 ---&gt; 8454f6fab960
Step 6/8 : RUN yum -y install net-tools
 ---&gt; Running in 173fc318f351
Loaded plugins: fastestmirror, ovl
Loading mirror speeds from cached hostfile
 * base: mirrors.nju.edu.cn
 * extras: ftp.sjtu.edu.cn
 * updates: ftp.sjtu.edu.cn
Resolving Dependencies
--&gt; Running transaction check
---&gt; Package net-tools.x86_64 0:2.0-0.25.20131004git.el7 will be installed
--&gt; Finished Dependency Resolution

Dependencies <span class="nv">Resolved</span>

<span class="o">================================================================================</span>
 Package         Arch         Version                          Repository  <span class="nv">Size</span>
<span class="o">================================================================================</span>
Installing:
 net-tools       x86_64       2.0-0.25.20131004git.el7         base       <span class="m">306</span> k

Transaction <span class="nv">Summary</span>
<span class="o">================================================================================</span>
Install  <span class="m">1</span> Package

Total download size: <span class="m">306</span> k
Installed size: <span class="m">917</span> k
Downloading packages:
Running transaction check
Running transaction <span class="nb">test</span>
Transaction <span class="nb">test</span> succeeded
Running transaction
  Installing : net-tools-2.0-0.25.20131004git.el7.x86_64                    1/1
  Verifying  : net-tools-2.0-0.25.20131004git.el7.x86_64                    1/1

Installed:
  net-tools.x86_64 0:2.0-0.25.20131004git.el7

Complete!
Removing intermediate container 173fc318f351
 ---&gt; 6a1de638647d
Step 7/8 : EXPOSE <span class="m">80</span>
 ---&gt; Running in b307ec95e208
Removing intermediate container b307ec95e208
 ---&gt; 23b8c33b96c8
Step 8/8 : CMD /bin/bash
 ---&gt; Running in 46eb85a62efa
Removing intermediate container 46eb85a62efa
 ---&gt; 847c2b869d18
Successfully built 847c2b869d18
Successfully tagged mycentos:latest
</code></pre></td></tr></table>
</div>
</div><p>发现images列表已经有了mycentos镜像</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">$ sdr images
REPOSITORY   TAG       IMAGE ID       CREATED         SIZE
mycentos     latest    847c2b869d18   <span class="m">2</span> minutes ago   624MB
</code></pre></td></tr></table>
</div>
</div><p>通过docker history查看镜像构建历史</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">$ sdr <span class="nb">history</span> <span class="m">847</span>
IMAGE          CREATED         CREATED BY                                      SIZE      COMMENT
847c2b869d18   <span class="m">5</span> minutes ago   /bin/sh -c <span class="c1">#(nop)  CMD [&#34;/bin/sh&#34; &#34;-c&#34; &#34;/bin…   0B</span>
23b8c33b96c8   <span class="m">5</span> minutes ago   /bin/sh -c <span class="c1">#(nop)  EXPOSE 80                    0B</span>
6a1de638647d   <span class="m">5</span> minutes ago   /bin/sh -c yum -y install net-tools             182MB
8454f6fab960   <span class="m">5</span> minutes ago   /bin/sh -c yum -y install vim                   237MB
0aed096774e0   <span class="m">6</span> minutes ago   /bin/sh -c <span class="c1">#(nop) WORKDIR /usr/local            0B</span>
3c456a5a6c70   <span class="m">6</span> minutes ago   /bin/sh -c <span class="c1">#(nop)  ENV MYPATH=/usr/local        0B</span>
7cc6b3b953d1   <span class="m">6</span> minutes ago   /bin/sh -c <span class="c1">#(nop)  MAINTAINER wnqinm&lt;flidwal…   0B</span>
eeb6ee3f44bd   <span class="m">12</span> months ago   /bin/sh -c <span class="c1">#(nop)  CMD [&#34;/bin/bash&#34;]            0B</span>
&lt;missing&gt;      <span class="m">12</span> months ago   /bin/sh -c <span class="c1">#(nop)  LABEL org.label-schema.sc…   0B</span>
&lt;missing&gt;      <span class="m">12</span> months ago   /bin/sh -c <span class="c1">#(nop) ADD file:b3ebbe8bd304723d4…   204MB</span>
</code></pre></td></tr></table>
</div>
</div><p>可以通过此命令查看各种官方镜像的构建过程</p>
<h2 id="发布镜像到dockerhub">发布镜像到dockerhub</h2>
<p>docker login -u 用户名</p>
<p>docker push 镜像</p>
<p>注意:镜像必须是 用户名/镜像名:tag   (eg. wnqinm/nginx:latest)</p>
<h1 id="docker-网络">docker 网络</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">$ ip addr
<span class="c1"># 本机回环地址</span>
1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu <span class="m">65536</span> qdisc noqueue state UNKNOWN group default qlen <span class="m">1000</span>
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host
       valid_lft forever preferred_lft forever
<span class="c1"># 服务器提供商(这里是腾讯云)内网地址</span>
2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu <span class="m">1500</span> qdisc mq state UP group default qlen <span class="m">1000</span>
    link/ether 52:54:00:a8:6e:ca brd ff:ff:ff:ff:ff:ff
    inet 10.0.4.3/22 brd 10.0.7.255 scope global eth0
       valid_lft forever preferred_lft forever
    inet6 fe80::5054:ff:fea8:6eca/64 scope link
       valid_lft forever preferred_lft forever
<span class="c1"># docker0地址</span>
3: docker0: &lt;NO-CARRIER,BROADCAST,MULTICAST,UP&gt; mtu <span class="m">1500</span> qdisc noqueue state DOWN group default
    link/ether 02:42:6c:11:67:c5 brd ff:ff:ff:ff:ff:ff
    inet 172.17.0.1/16 brd 172.17.255.255 scope global docker0
       valid_lft forever preferred_lft forever
    inet6 fe80::42:6cff:fe11:67c5/64 scope link
       valid_lft forever preferred_lft forever
</code></pre></td></tr></table>
</div>
</div><p>查看一下容器内部地址</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">$ sdr ps -a
CONTAINER ID   IMAGE          COMMAND       CREATED      STATUS
9293afcf31a6   3d1465         <span class="s2">&#34;/bin/bash&#34;</span>   <span class="m">4</span> days ago   Up <span class="m">2</span> seconds

<span class="c1"># 可以在exec后直接加命令,不进入容器直接执行</span>
$ sdr <span class="nb">exec</span> -it <span class="m">9293</span> ip addr
1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu <span class="m">65536</span> qdisc noqueue state UNKNOWN group default qlen <span class="m">1000</span>
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
92: eth0@if93: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu <span class="m">1500</span> qdisc noqueue state UP group default
    link/ether 02:42:ac:11:00:02 brd ff:ff:ff:ff:ff:ff link-netnsid <span class="m">0</span>
    inet 172.17.0.2/16 brd 172.17.255.255 scope global eth0
       valid_lft forever preferred_lft forever
<span class="c1"># 每一个容器都会有一个类似上面的eth0@if93的网卡对应的ip地址172.17.0.2/16,这是docker分配的</span>

<span class="c1"># ping一下</span>
$ ping 172.17.0.2
PING 172.17.0.2 <span class="o">(</span>172.17.0.2<span class="o">)</span> 56<span class="o">(</span>84<span class="o">)</span> bytes of data.
<span class="m">64</span> bytes from 172.17.0.2: <span class="nv">icmp_seq</span><span class="o">=</span><span class="m">1</span> <span class="nv">ttl</span><span class="o">=</span><span class="m">64</span> <span class="nv">time</span><span class="o">=</span>0.094 ms
<span class="m">64</span> bytes from 172.17.0.2: <span class="nv">icmp_seq</span><span class="o">=</span><span class="m">2</span> <span class="nv">ttl</span><span class="o">=</span><span class="m">64</span> <span class="nv">time</span><span class="o">=</span>0.049 ms
<span class="m">64</span> bytes from 172.17.0.2: <span class="nv">icmp_seq</span><span class="o">=</span><span class="m">3</span> <span class="nv">ttl</span><span class="o">=</span><span class="m">64</span> <span class="nv">time</span><span class="o">=</span>0.044 ms
<span class="m">64</span> bytes from 172.17.0.2: <span class="nv">icmp_seq</span><span class="o">=</span><span class="m">4</span> <span class="nv">ttl</span><span class="o">=</span><span class="m">64</span> <span class="nv">time</span><span class="o">=</span>0.046 ms
^C
--- 172.17.0.2 ping statistics ---
<span class="m">4</span> packets transmitted, <span class="m">4</span> received, 0% packet loss, <span class="nb">time</span> 3079ms
<span class="c1"># 可以ping通</span>

<span class="c1"># 容器反过来ping主机</span>
$ sdr <span class="nb">exec</span> -it <span class="m">9293</span> ping 172.17.0.1
PING 172.17.0.1 <span class="o">(</span>172.17.0.1<span class="o">)</span> 56<span class="o">(</span>84<span class="o">)</span> bytes of data.
<span class="m">64</span> bytes from 172.17.0.1: <span class="nv">icmp_seq</span><span class="o">=</span><span class="m">1</span> <span class="nv">ttl</span><span class="o">=</span><span class="m">64</span> <span class="nv">time</span><span class="o">=</span>0.055 ms
<span class="m">64</span> bytes from 172.17.0.1: <span class="nv">icmp_seq</span><span class="o">=</span><span class="m">2</span> <span class="nv">ttl</span><span class="o">=</span><span class="m">64</span> <span class="nv">time</span><span class="o">=</span>0.050 ms
<span class="m">64</span> bytes from 172.17.0.1: <span class="nv">icmp_seq</span><span class="o">=</span><span class="m">3</span> <span class="nv">ttl</span><span class="o">=</span><span class="m">64</span> <span class="nv">time</span><span class="o">=</span>0.053 ms
<span class="m">64</span> bytes from 172.17.0.1: <span class="nv">icmp_seq</span><span class="o">=</span><span class="m">4</span> <span class="nv">ttl</span><span class="o">=</span><span class="m">64</span> <span class="nv">time</span><span class="o">=</span>0.062 ms
^C
--- 172.17.0.1 ping statistics ---
<span class="m">4</span> packets transmitted, <span class="m">4</span> received, 0% packet loss, <span class="nb">time</span> 3059ms
<span class="c1"># 也能ping通</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>原理</p>
</blockquote>
<p>首先,docker0的ip:172.17.0.1,容器9293的ip:172.17.0.2,是在同一网段下的</p>
<ol>
<li>每次运行一个容器,docker就会分配一个ip,我们只要安装了docker,就会有一个网卡docker0</li>
</ol>
<p>桥接模式,使用的是 evth-pair 技术</p>
<ol start="2">
<li>再次测试ip addr:</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">$ ip addr
1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu <span class="m">65536</span> qdisc noqueue state UNKNOWN group default qlen <span class="m">1000</span>
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host
       valid_lft forever preferred_lft forever
2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu <span class="m">1500</span> qdisc mq state UP group default qlen <span class="m">1000</span>
    link/ether 52:54:00:a8:6e:ca brd ff:ff:ff:ff:ff:ff
    inet 10.0.4.3/22 brd 10.0.7.255 scope global eth0
       valid_lft forever preferred_lft forever
    inet6 fe80::5054:ff:fea8:6eca/64 scope link
       valid_lft forever preferred_lft forever
3: docker0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu <span class="m">1500</span> qdisc noqueue state UP group default
    link/ether 02:42:6c:11:67:c5 brd ff:ff:ff:ff:ff:ff
    inet 172.17.0.1/16 brd 172.17.255.255 scope global docker0
       valid_lft forever preferred_lft forever
    inet6 fe80::42:6cff:fe11:67c5/64 scope link
       valid_lft forever preferred_lft forever
93: veth8b8785a@if92: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu <span class="m">1500</span> qdisc noqueue master docker0 state UP group default
    link/ether 6a:fc:42:63:d2:cf brd ff:ff:ff:ff:ff:ff link-netnsid <span class="m">1</span>
    inet6 fe80::68fc:42ff:fe63:d2cf/64 scope link
       valid_lft forever preferred_lft forever
</code></pre></td></tr></table>
</div>
</div><p>发现多了一个网卡</p>
<p>可以明白容器带来的网卡，都是一对对的</p>
<p>evth-pair就是一对虚拟设备接口，都是成对出现的，一端连着协议，一端彼此相连</p>
<p>所以evth-pair被用来充当桥梁</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tvax3.sinaimg.cn/large/007Z9xVHgy1h6gfgwgbtgj30xy0d6t9u.jpg"
        data-srcset="https://tvax3.sinaimg.cn/large/007Z9xVHgy1h6gfgwgbtgj30xy0d6t9u.jpg, https://tvax3.sinaimg.cn/large/007Z9xVHgy1h6gfgwgbtgj30xy0d6t9u.jpg 1.5x, https://tvax3.sinaimg.cn/large/007Z9xVHgy1h6gfgwgbtgj30xy0d6t9u.jpg 2x"
        data-sizes="auto"
        alt="https://tvax3.sinaimg.cn/large/007Z9xVHgy1h6gfgwgbtgj30xy0d6t9u.jpg"
        title="evth-pair" /></p>
<p>主机上显示93: veth8b8785a@if92，93号，指向92号。而容器内显示92: eth0@if93，92号，指向93号，说明这两块网卡是互相绑定的</p>
<ol start="3">
<li>容器间ping</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">$ sdr <span class="nb">exec</span> -it <span class="m">9293</span> ping 172.20.0.2
PING 172.20.0.2 <span class="o">(</span>172.20.0.2<span class="o">)</span> 56<span class="o">(</span>84<span class="o">)</span> bytes of data.
^C
--- 172.20.0.2 ping statistics ---
<span class="m">8</span> packets transmitted, <span class="m">0</span> received, 100% packet loss, <span class="nb">time</span> 7170ms
</code></pre></td></tr></table>
</div>
</div><p>这里ping不通的原因是两个容器的ip字段不同，即不在一个网桥下</p>
<p>如果ping同一网桥下的容器：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">$ sdr <span class="nb">exec</span> -it <span class="m">9293</span> ping 172.17.0.3
</code></pre></td></tr></table>
</div>
</div><p>此时就能ping通，我这里就不试了</p>
<p>网络模型图如下：</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tva2.sinaimg.cn/large/007Z9xVHgy1h6gfyu20jej30z20mmjut.jpg"
        data-srcset="https://tva2.sinaimg.cn/large/007Z9xVHgy1h6gfyu20jej30z20mmjut.jpg, https://tva2.sinaimg.cn/large/007Z9xVHgy1h6gfyu20jej30z20mmjut.jpg 1.5x, https://tva2.sinaimg.cn/large/007Z9xVHgy1h6gfyu20jej30z20mmjut.jpg 2x"
        data-sizes="auto"
        alt="https://tva2.sinaimg.cn/large/007Z9xVHgy1h6gfyu20jej30z20mmjut.jpg"
        title="docker0" /></p>
<p>所有容器在不指定网络的情况下，都是docker0路由的，docker会给容器分配一个默认的可用ip</p>
<p>ip数目：255.255.255.255/16表示前16位是域，后16位是可分配的ip，此时255.255.0.1到255.255.255.254可用ip；255.255.255.255/24表示前24位是域，后8位是可分配的ip，此时255.255.255.1到255.255.255.254是可用ip</p>
<p><strong>可以通过修改/etc/hosts添加容器名实现通过容器名ping通网络</strong></p>
<h2 id="自定义网络">自定义网络</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="c1"># 查看所有的docker网络</span>
$ sdr network ls
NETWORK ID     NAME                  DRIVER    SCOPE
4171a585caf4   bridge                bridge    <span class="nb">local</span>
3c8399a3e6b0   code-server_default   bridge    <span class="nb">local</span>
bf9782f177ef   host                  host      <span class="nb">local</span>
8c71ba624052   none                  null      <span class="nb">local</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>网络模式</strong></p>
<p>bridge：桥接 docker(默认)</p>
<p>none：不配置网络</p>
<p>host：和宿主机共享网络</p>
<p>container：容器内网络连通（用的少，局限性很大）</p>
<p><strong>测试</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="c1"># 启动容器时可以指定网络</span>
docker run -d -P --name tomcat01 --net bridge tomcat
<span class="c1"># 这里的bridge就是前面network ls的第一个网络</span>
<span class="c1"># docker0特点:默认,域名不能访问</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>自定义网络</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="c1"># --driver bridge  设置网络模式</span>
<span class="c1"># --subnet 192.168.0.0/16   设置子网地址</span>
<span class="c1"># --gateway 192.168.0.1   网关</span>
$ sdr network create --driver bridge --subnet 192.168.0.0/16 --gateway 192.168.0.1 mynet
41eac8b4e2753f31116056357cabae0efc0f34259010c2b5b9244acceac34387
$ sdr network ls
NETWORK ID     NAME                  DRIVER    SCOPE
41eac8b4e275   mynet                 bridge    <span class="nb">local</span>
$ sdr network inspect mynet
<span class="o">[</span>
    <span class="o">{</span>
        <span class="s2">&#34;Name&#34;</span>: <span class="s2">&#34;mynet&#34;</span>,
        <span class="s2">&#34;Id&#34;</span>: <span class="s2">&#34;41eac8b4e2753f31116056357cabae0efc0f34259010c2b5b9244acceac34387&#34;</span>,
        <span class="s2">&#34;Created&#34;</span>: <span class="s2">&#34;2022-09-23T15:43:55.370425457+08:00&#34;</span>,
        <span class="s2">&#34;Scope&#34;</span>: <span class="s2">&#34;local&#34;</span>,
        <span class="s2">&#34;Driver&#34;</span>: <span class="s2">&#34;bridge&#34;</span>,
        <span class="s2">&#34;EnableIPv6&#34;</span>: false,
        <span class="s2">&#34;IPAM&#34;</span>: <span class="o">{</span>
            <span class="s2">&#34;Driver&#34;</span>: <span class="s2">&#34;default&#34;</span>,
            <span class="s2">&#34;Options&#34;</span>: <span class="o">{}</span>,
            <span class="s2">&#34;Config&#34;</span>: <span class="o">[</span>
                <span class="o">{</span>
                    <span class="s2">&#34;Subnet&#34;</span>: <span class="s2">&#34;192.168.0.0/16&#34;</span>,
                    <span class="s2">&#34;Gateway&#34;</span>: <span class="s2">&#34;192.168.0.1&#34;</span>
                <span class="o">}</span>
            <span class="o">]</span>
        <span class="o">}</span>,
        <span class="s2">&#34;Internal&#34;</span>: false,
        <span class="s2">&#34;Attachable&#34;</span>: false,
        <span class="s2">&#34;Ingress&#34;</span>: false,
        <span class="s2">&#34;ConfigFrom&#34;</span>: <span class="o">{</span>
            <span class="s2">&#34;Network&#34;</span>: <span class="s2">&#34;&#34;</span>
        <span class="o">}</span>,
        <span class="s2">&#34;ConfigOnly&#34;</span>: false,
        <span class="s2">&#34;Containers&#34;</span>: <span class="o">{}</span>,
        <span class="s2">&#34;Options&#34;</span>: <span class="o">{}</span>,
        <span class="s2">&#34;Labels&#34;</span>: <span class="o">{}</span>
    <span class="o">}</span>
<span class="o">]</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="网络连通">网络连通</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">$ sdr network connect --help

Usage:  docker network connect <span class="o">[</span>OPTIONS<span class="o">]</span> NETWORK CONTAINER

Connect a container to a network

Options:
      --alias strings           Add network-scoped <span class="nb">alias</span> <span class="k">for</span> the container
      --driver-opt strings      driver options <span class="k">for</span> the network
      --ip string               IPv4 address <span class="o">(</span>e.g., 172.30.100.104<span class="o">)</span>
      --ip6 string              IPv6 address <span class="o">(</span>e.g., 2001:db8::33<span class="o">)</span>
      --link list               Add link to another container
      --link-local-ip strings   Add a link-local address <span class="k">for</span> the container
</code></pre></td></tr></table>
</div>
</div><p>原理是再给容器分配一个ip地址，干脆利落直接将容器添加到其他网络中。</p></div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>更新于 2022-10-12</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"><span>
                            <a class="link-to-markdown" href="/2022/09/docker_init/index.md" target="_blank">阅读原始文档</a>
                        </span></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="分享到 Twitter" data-sharer="twitter" data-url="https://WnQinm.github.io/2022/09/docker_init/" data-title="Docker" data-hashtags="net,docker"><i class="fab fa-twitter fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="分享到 Reddit" data-sharer="reddit" data-url="https://WnQinm.github.io/2022/09/docker_init/"><i class="fab fa-reddit fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="分享到 微博" data-sharer="weibo" data-url="https://WnQinm.github.io/2022/09/docker_init/" data-title="Docker"><i class="fab fa-weibo fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="分享到 百度" data-sharer="baidu" data-url="https://WnQinm.github.io/2022/09/docker_init/" data-title="Docker"><i data-svg-src="https://cdn.jsdelivr.net/npm/simple-icons@7.3.0/icons/baidu.svg" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/net/">net</a>,&nbsp;<a href="/tags/docker/">docker</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">返回</a></span>&nbsp;|&nbsp;<span><a href="/">主页</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/2022/09/clash_linux/" class="prev" rel="prev" title="Clash for linux"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>Clash for linux</a>
            <a href="/2022/09/html_init/" class="next" rel="next" title="html初识">html初识<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
<div id="comments"><script src="https://utteranc.es/client.js" repo="WnQinm/WnQinm.github.io"
                issue-term="title" theme="github-light" crossorigin="anonymous"
                async>
            </script></div></article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">River flies, sky lies.</div><div class="footer-line">由 <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.68.3">Hugo</a> 强力驱动 | 主题 - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden="true"></i> LoveIt</a>
                </div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2022</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank">清梦</a></span><span class="icp-splitter">&nbsp;|&nbsp;</span><br class="icp-br"/>
                    <span class="icp"><a href="https://beian.miit.gov.cn/" target="_blank">晋ICP备2022008210号-1</a></span></div>
        </div>
    </footer>
        </div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="回到顶部">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="查看评论">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css"><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/auto-render.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/copy-tex.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/mhchem.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"复制到剪贴板","maxShownLines":50},"comment":{},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":true,"left":"\\begin{equation}","right":"\\end{equation}"},{"display":true,"left":"\\begin{equation*}","right":"\\end{equation*}"},{"display":true,"left":"\\begin{align}","right":"\\end{align}"},{"display":true,"left":"\\begin{align*}","right":"\\end{align*}"},{"display":true,"left":"\\begin{alignat}","right":"\\end{alignat}"},{"display":true,"left":"\\begin{alignat*}","right":"\\end{alignat*}"},{"display":true,"left":"\\begin{gather}","right":"\\end{gather}"},{"display":true,"left":"\\begin{CD}","right":"\\end{CD}"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
